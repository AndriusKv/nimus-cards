(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{111:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return s}));const n=new(a(124).a)("nimus-cards");function c(){return n.decks.toArray().catch(e=>{console.log(e)})}function l(e){return n.decks.get(e)}function i(e){n.decks.put(e).catch(e=>{console.log(e)})}function s(e){n.decks.delete(e).catch(e=>{console.log(e)})}n.version(1).stores({decks:"id"})},118:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return c}));a(133),a(104);function n(e){const t=[].concat(e);let a=t.length;for(;a;){const e=Math.floor(Math.random()*a);a-=1,[t[a],t[e]]=[t[e],t[a]]}return t}function c(){return Math.random().toString(32).slice(2,10)}},125:function(e,t,a){"use strict";var n=a(56),c=a(15),l=a(2),i=a(9),s=a(13),r=a(20).f,o=a(64),u=l.Symbol;if(c&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var m={},d=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof d?new u(e):void 0===e?u():u(e);return""===e&&(m[t]=!0),t};o(d,u);var p=d.prototype=u.prototype;p.constructor=d;var f=p.toString,E="Symbol(test)"==String(u("test")),h=/^Symbol\((.*)\)[^)]+$/;r(p,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=f.call(e);if(i(m,e))return"";var a=E?t.slice(7,-1):t.replace(h,"$1");return""===a?void 0:a}}),n({global:!0,forced:!0},{Symbol:d})}},142:function(e,t,a){"use strict";var n=a(126),c=a(134),l=a(11),i=a(57),s=a(73),r=a(127),o=a(34),u=a(129),m=a(117),d=a(12),p=[].push,f=Math.min,E=!d((function(){return!RegExp(4294967295,"y")}));n("split",2,(function(e,t,a){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,a){var n=String(i(this)),l=void 0===a?4294967295:a>>>0;if(0===l)return[];if(void 0===e)return[n];if(!c(e))return t.call(n,e,l);for(var s,r,o,u=[],d=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,E=new RegExp(e.source,d+"g");(s=m.call(E,n))&&!((r=E.lastIndex)>f&&(u.push(n.slice(f,s.index)),s.length>1&&s.index<n.length&&p.apply(u,s.slice(1)),o=s[0].length,f=r,u.length>=l));)E.lastIndex===s.index&&E.lastIndex++;return f===n.length?!o&&E.test("")||u.push(""):u.push(n.slice(f)),u.length>l?u.slice(0,l):u}:"0".split(void 0,0).length?function(e,a){return void 0===e&&0===a?[]:t.call(this,e,a)}:t,[function(t,a){var c=i(this),l=null==t?void 0:t[e];return void 0!==l?l.call(t,c,a):n.call(String(c),t,a)},function(e,c){var i=a(n,e,this,c,n!==t);if(i.done)return i.value;var m=l(e),d=String(this),p=s(m,RegExp),h=m.unicode,v=(m.ignoreCase?"i":"")+(m.multiline?"m":"")+(m.unicode?"u":"")+(E?"y":"g"),b=new p(E?m:"^(?:"+m.source+")",v),g=void 0===c?4294967295:c>>>0;if(0===g)return[];if(0===d.length)return null===u(b,d)?[d]:[];for(var y=0,x=0,N=[];x<d.length;){b.lastIndex=E?x:0;var k,O=u(b,E?d:d.slice(x));if(null===O||(k=f(o(b.lastIndex+(E?0:x)),d.length))===y)x=r(d,x,h);else{if(N.push(d.slice(y,x)),N.length===g)return N;for(var C=1;C<=O.length-1;C++)if(N.push(O[C]),N.length===g)return N;x=y=k}}return N.push(d.slice(y)),N}]}),!E)},156:function(e,t,a){"use strict";a.r(t);a(125),a(106),a(131),a(104);var n=a(0),c=a.n(n);const l=Object(n.createContext)(null);function i({children:e}){const[t,a]=Object(n.useReducer)(r,{title:"",description:"",cards:[]}),i=Object(n.useMemo)(()=>({state:t,dispatch:a}),[t]);return c.a.createElement(l.Provider,{value:i},e)}function s(){return Object(n.useContext)(l)}function r(e,t){const a=e.cards[t.index];switch(t.type){case"RESET_DECK":return Object.assign({},t.deck);case"UPDATE_DECK":return Object.assign({},e,{[t.name]:t.value});case"ADD_CARD":return Object.assign({},e,{cards:[...e.cards,t.card]});case"REMOVE_CARD":return e.cards.splice(t.index,1),Object.assign({},e);case"UPDATE_CARD_VALUE":return a[t.name][t.key]=t.value,Object.assign({},e);case"ADD_ATTACHMENT":return a.front.attachment=t.attachment,Object.assign({},e);case"REMOVE_ATTACHMENT":return delete a.front.attachment,Object.assign({},e);case"UPDATE_CARD_BACK":return a.back=Object.assign({},a.back,{},t.payload),Object.assign({},e);default:return e}}var o=a(118),u=a(111),m=a(14);function d({textSize:e,handleChange:t}){return c.a.createElement("select",{className:"input create-side-select",title:"Text size",defaultValue:e,onChange:t},c.a.createElement("option",{value:"16"},"16px"),c.a.createElement("option",{value:"24"},"24px"),c.a.createElement("option",{value:"36"},"36px"),c.a.createElement("option",{value:"48"},"48px"))}a(142);function p(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class f extends c.a.Component{constructor(e){super(e),p(this,"hide",()=>{this.props.hide()}),p(this,"handleFileUpload",({target:e})=>{const{type:t}=this.props,[a]=e.files;e.value="",a.type.split("/")[0]!==t?this.showMessage(`File is not an ${t}`):this.props.addAttachment(a,t)}),p(this,"handleFileUploadFormURL",e=>{const t=e.target.elements.url.value.trim(),{type:a}=this.props;if(e.preventDefault(),t){if("image"===a){const e=new Image;e.onload=()=>{this.props.addAttachment(t,a)},e.onerror=e=>{this.showMessage(`URL doesn't contain ${a} file`),console.log(e)},e.src=t}else if("audio"===a){const e=new Audio(t);e.onloadedmetadata=()=>{this.props.addAttachment(t,a)},e.onerror=e=>{this.showMessage(`URL doesn't contain ${a} file`),console.log(e)}}}else this.showMessage("Please specify valid url")}),this.state={message:""}}showMessage(e){this.setState({message:e}),setTimeout(()=>{this.setState({message:""})},3200)}render(){const{type:e}=this.props,{message:t}=this.state;return c.a.createElement("div",{className:"mask"},c.a.createElement("div",{className:"modal upload-panel"},c.a.createElement("div",{className:"upload-panel-device-target"},c.a.createElement("div",{className:"upload-panel-device-target-title"},"Select ",e," file from device"),c.a.createElement("label",{className:"btn",tabIndex:"0"},c.a.createElement("span",null,"Select"),c.a.createElement("input",{type:"file",className:"file-input",onChange:this.handleFileUpload}))),c.a.createElement("div",{className:"upload-panel-item-separator"},"Or"),c.a.createElement("div",{className:"upload-panel-url-target"},c.a.createElement("div",{className:"upload-panel-url-target-title"},"Upload ",e," from url"),c.a.createElement("form",{onSubmit:this.handleFileUploadFormURL},c.a.createElement("input",{type:"text",name:"url",className:"input upload-panel-url-target-input"}),c.a.createElement("button",{className:"btn"},"Upload"))),c.a.createElement("div",{className:"upload-panel-footer"},t&&c.a.createElement("div",{className:"upload-panel-message"},t),c.a.createElement("button",{type:"button",className:"btn btn-text",onClick:this.hide},"Cancel"))))}}a(135);function E({file:e,type:t}){const a="string"==typeof e?e:URL.createObjectURL(e);return"image"===t?c.a.createElement("img",{src:a,alt:"",className:"create-side-image"}):"audio"===t?c.a.createElement("audio",{src:a,className:"create-side-audio",controls:!0}):null}function h({index:e,side:t,handleChange:a}){const{dispatch:l}=s(),[i,r]=Object(n.useState)({type:"",visible:!1}),{text:o,textSize:u,attachment:p}=t;function h(){l({type:"REMOVE_ATTACHMENT",index:e})}function v(){r({visible:!1,type:""})}return c.a.createElement(n.Fragment,null,c.a.createElement("div",null,c.a.createElement("div",{className:"deck-form-field-title"},"FRONT"),c.a.createElement("div",{className:"create-side-toolbar"},["image","audio"].map((e,t)=>c.a.createElement("button",{key:t,className:"btn btn-icon toolbar-btn",title:`Upload ${e}`,onClick:()=>function(e){r({visible:!0,type:e})}(e)},c.a.createElement(m.a,{name:e}))),c.a.createElement(d,{textSize:u,handleChange:e=>a(e,"front","textSize")})),c.a.createElement("div",{className:"create-side-content"},p&&c.a.createElement("div",{className:"create-side-panel"},c.a.createElement("button",{type:"button",className:"btn btn-icon create-side-panel-btn",onClick:h,title:"Remove attachment"},c.a.createElement(m.a,{name:"remove"})),c.a.createElement(E,p)),c.a.createElement("textarea",{className:"input create-side-text-input",value:o,style:{fontSize:`${u}px`},onChange:e=>a(e,"front","text")}))),i.visible&&c.a.createElement(f,{type:i.type,hide:v,addAttachment:function(t,a){l({type:"ADD_ATTACHMENT",index:e,attachment:{file:t,type:a}}),v()}}))}function v({index:e}){const{state:t,dispatch:a}=s(),{back:l,id:i}=t.cards[e],{type:r,textOptions:u,multiOptions:p,exactOptions:f}=l;function E(t){a({type:"UPDATE_CARD_BACK",index:e,payload:t})}function h({target:e},t){const{value:a}=e;a!==l[t]&&(u[t]=a,E({textOptions:u}))}function v({target:e}){p.layout=e.value,E({multiOptions:p})}function b({target:e}){const{name:t,value:a}=e,n=p.options[t];a!==n.value&&(n.value=a,E({multiOptions:p}))}function g({target:e}){const{name:t,value:a,checked:n}=e;"caseSensitive"===t?f.caseSensitive=n:f.value=a,E({exactOptions:f})}function y(){return c.a.createElement(n.Fragment,null,c.a.createElement("div",{className:"create-multi-layout"},c.a.createElement("div",{className:"create-multi-layout-title"},"Layout"),c.a.createElement("div",{onInput:v,className:"create-multi-layout-items"},c.a.createElement("label",{className:"create-multi-layout-item"},c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:`multi-${i}`,value:"short",defaultChecked:"short"===p.layout}),c.a.createElement(m.a,{name:"grid",className:"create-option-type-icon"})),c.a.createElement("label",{className:"create-multi-layout-item"},c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:`multi-${i}`,value:"medium",defaultChecked:"medium"===p.layout}),c.a.createElement(m.a,{name:"list-2-col",className:"create-option-type-icon"})),c.a.createElement("label",{className:"create-multi-layout-item"},c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:`multi-${i}`,value:"long",defaultChecked:"long"===p.layout}),c.a.createElement(m.a,{name:"menu",className:"create-option-type-icon"})))),c.a.createElement("ul",null,p.options.map(({id:e,value:t},a)=>c.a.createElement("li",{className:"create-option",key:e},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only radio-input",name:i,checked:p.correctId===e,onChange:()=>function(e){p.correctId=e,E({multiOptions:p})}(e)}),c.a.createElement("div",{className:"radio create-option-radio",title:"Mark answer as correct"})),c.a.createElement("input",{type:"text",className:"input create-option-input",name:a,defaultValue:t,autoComplete:"off",onChange:b}),c.a.createElement("button",{className:"btn btn-icon",title:"Remove answer",onClick:()=>{return e=a,p.options.splice(e,1),void E({multiOptions:p});var e}},c.a.createElement(m.a,{name:"remove"}))))))}return c.a.createElement("div",null,c.a.createElement("div",{className:"deck-form-field-title"},"BACK"),c.a.createElement("div",{className:"create-side-toolbar"},c.a.createElement("ul",{className:"create-side-types",onChange:function({target:e}){E({type:e.value})}},c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:`type-${i}`,value:"text",defaultChecked:"text"===r}),c.a.createElement(m.a,{name:"text",title:"Text",className:"create-option-type-icon"}))),c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:`type-${i}`,value:"multi",defaultChecked:"multi"===r}),c.a.createElement(m.a,{name:"list-checkbox",title:"Multiple choice",className:"create-option-type-icon"}))),c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:`type-${i}`,value:"exact",defaultChecked:"exact"===r}),c.a.createElement(m.a,{name:"text-short",title:"Exact answer",className:"create-option-type-icon"})))),"text"===r&&c.a.createElement(d,{textSize:u.textSize,handleChange:e=>h(e,"textSize")}),"multi"===r&&c.a.createElement("button",{className:"btn btn-icon",onClick:function(){p.options.push({id:Object(o.a)()}),E({multiOptions:p})},title:"Add option"},c.a.createElement(m.a,{name:"add-list-item"}))),c.a.createElement("div",{className:"create-side-content"},function(e){return"text"===e?c.a.createElement("textarea",{className:"input create-side-text-input",value:u.value,style:{fontSize:`${u.textSize}px`},onChange:e=>h(e,"value")}):"multi"===e?y():"exact"===e?c.a.createElement("div",{onChange:g},c.a.createElement("label",{className:"creact-exact-input-container"},c.a.createElement("div",{className:"creact-exact-input-title"},"Provide answer:"),c.a.createElement("input",{type:"text",className:"input creact-exact-input",name:"input",autoComplete:"off",defaultValue:f.value})),c.a.createElement("label",{className:"checkbox-container creact-exact-checkbox-container"},c.a.createElement("input",{type:"checkbox",className:"sr-only checkbox-input",name:"caseSensitive",defaultChecked:f.caseSensitive}),c.a.createElement("div",{className:"checkbox create-checkbox"},c.a.createElement("div",{className:"checkbox-tick"})),c.a.createElement("span",{className:"checkbox-label"},"Case sensitive"))):null}(r)))}function b({value:e,handleChange:t}){return c.a.createElement("div",{className:"deck-form-card-notes-container"},c.a.createElement("div",{className:"deck-form-field-title"},"NOTES"),c.a.createElement("textarea",{className:"input deck-form-card-notes-input",value:e,onChange:e=>t(e,"notes","value")}))}function g({index:e,card:t,removeCard:a}){const{state:l,dispatch:i}=s(),[r,o]=Object(n.useState)(t.notes&&!!t.notes.value);function u({target:a},n,c){const{value:l}=a;l!==t[n][c]&&i({type:"UPDATE_CARD_VALUE",index:e,name:n,key:c,value:l})}return c.a.createElement("li",{className:"create-list-item"},c.a.createElement("div",{className:"create-card-index"},e+1,"."),c.a.createElement("div",{className:"deck-form-field-group create-card"},c.a.createElement(h,{index:e,side:t.front,handleChange:u}),c.a.createElement(v,{index:e}),r&&c.a.createElement(b,{value:t.notes.value,handleChange:u})),c.a.createElement("div",{className:"create-card-btns"},c.a.createElement("button",{className:"btn btn-icon",title:"Toggle notes",onClick:function(){o(!r)}},c.a.createElement(m.a,{name:"notes"})),l.cards.length>1&&c.a.createElement("button",{className:"btn btn-icon",title:"Remove card",onClick:()=>a(e)},c.a.createElement(m.a,{name:"remove"}))))}function y(e){const{state:t,dispatch:a}=s(),[l,i]=Object(n.useState)(""),[r,m]=Object(n.useState)([]),d=Object(n.useRef)();let p=0,f=0;function E(){return{id:Object(o.a)(),front:{text:"",textSize:16},back:{type:"text",textOptions:{value:"",textSize:16},multiOptions:{correctId:"",layout:"short",options:[{id:Object(o.a)()},{id:Object(o.a)()}]},exactOptions:{caseSensitive:!1,value:""}},notes:{value:""}}}function h(e){const n=t.cards[e];(v(n.front)||b(n.back)||n.notes.value)&&m([...r,n]),a({type:"REMOVE_CARD",index:e})}function v(e){return e.text||e.attachment}function b(e){if("text"===e.type)return e.textOptions.value.length>0;if("exact"===e.type)return e.exactOptions.value.length>0;return e.multiOptions.options.reduce((e,{value:t})=>(t&&(e+=1),e),0)>1&&e.multiOptions.correctId}function y({target:e}){const{name:t,value:n}=e;a({type:"UPDATE_DECK",name:t,value:n})}return Object(n.useEffect)(()=>{const{id:t}=e.match.params;"/decks/create"===e.match.path?a({type:"RESET_DECK",deck:{id:Object(o.a)(),title:"",description:"",cards:[E()]}}):t&&Object(u.b)(t).then(e=>{e&&(e.cards=e.cards.map(e=>{const t=E();return t.front=e.front,t.back.type=e.back.type,t.back[`${e.back.type}Options`]=e.back.typeOptions,delete t.back.typeOptions,t}),a({type:"RESET_DECK",deck:e}))})},[]),Object(n.useEffect)(()=>(clearTimeout(p),p=setTimeout(()=>{i("")},3200),()=>{clearTimeout(p)}),[l]),Object(n.useEffect)(()=>(clearTimeout(f),r.length>0&&(f=setTimeout(()=>{m([])},8e3)),()=>{clearTimeout(f)}),[r.length]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"deck-form-field-group"},c.a.createElement("label",null,c.a.createElement("div",{className:"deck-form-field-title"},"TITLE"),c.a.createElement("input",{className:"input create-title-input",name:"title",value:t.title,onChange:y})),c.a.createElement("label",null,c.a.createElement("div",{className:"deck-form-field-title"},"DESCRIPTION (OPTIONAL)"),c.a.createElement("textarea",{className:"input create-description-input",name:"description",value:t.description,onChange:y}))),c.a.createElement("ul",null,t.cards.map((e,t)=>c.a.createElement(g,{key:e.id,index:t,card:e,removeCard:h}))),r.length>0&&c.a.createElement("div",{className:"deck-form-dialog"},c.a.createElement("span",null,"Removed ",r.length," card",r.length>1?"s":""),c.a.createElement("button",{className:"btn btn-text",onClick:function(){clearTimeout(f),m([]),a({type:"RESET_DECK",deck:Object.assign({},t,{cards:t.cards.concat(r)})})}},"UNDO")),c.a.createElement("div",{className:"create-footer"},c.a.createElement("button",{className:"btn",onClick:function(){const e=t.cards[t.cards.length-1],n=E();n.front.textSize=e.front.textSize,n.back.type=e.back.type,"text"===n.back.type?n.back.textOptions.textSize=e.back.textOptions.textSize:"multi"===n.back.type?n.back.multiOptions.layout=e.back.multiOptions.layout:"exact"===n.back.type&&(n.back.exactOptions.caseSensitive=e.back.exactOptions.caseSensitive),a({type:"ADD_CARD",card:n}),requestAnimationFrame(()=>{d.current.scrollIntoView()})},ref:d},"New Card"),l&&c.a.createElement("span",{className:"create-message"},l),c.a.createElement("button",{className:"btn",onClick:function(){if(!t.title)return void i("Title is required");(function(e){let t=0;for(const{front:a,back:n}of e)v(a)&&b(n)&&(t+=1);if(t!==e.length)i("Please fill in both card sides");else{if(!(t<2))return!0;i("Please fill in at least two cards")}})(t.cards)&&(t.cards=t.cards.map(e=>{const t={type:e.back.type,typeOptions:e.back[`${e.back.type}Options`]};return"multi"===t.type&&(t.typeOptions.options=e.back.multiOptions.options.filter(({value:e})=>e)),e.back=t,e}),e.history.push("/decks"),Object(u.d)(t))}},"Create")))}function x(e){return c.a.createElement(i,null,c.a.createElement(y,e))}a.d(t,"default",(function(){return x}))}}]);