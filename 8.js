(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{116:function(e,t,a){},117:function(e,t,a){},154:function(e,t,a){"use strict";a.r(t);a(30);var n=a(0),c=a.n(n),l=a(1),r=(a(116),a(101)),s=a.n(r),i=a(31),o=a(98),m=a(9),d=a(38);a(117);var u=function({addAttachment:e,errorMessage:t}){const[a,l]=Object(n.useState)(""),[r,s]=Object(n.useState)("image");function i(e){l(e),setTimeout(()=>{l("")},3200)}function o(){i(`URL does not contain valid ${r} file.`)}return c.a.createElement("div",{className:"upload-panel"},c.a.createElement("div",{className:"upload-type-selection"},["image","audio","video"].map((e,t)=>c.a.createElement("button",{className:"btn btn-icon-text upload-type-selection-btn"+(r===e?" active":""),onClick:()=>s(e),key:t},c.a.createElement(m.a,{name:e+"-file"}),c.a.createElement("span",null,e)))),c.a.createElement("div",{className:"upload-panel-content"},c.a.createElement("label",{className:"btn upload-panel-import-input-container"},c.a.createElement("span",null,"Select File"),c.a.createElement("input",{type:"file",className:"sr-only",onChange:function({target:t}){const[a]=t.files;t.value="",a.type.split("/")[0]!==r?i(`Selected file is not ${"v"===r[0]?"a":"an"} ${r} file.`):e({blob:a,type:r})}})),c.a.createElement("div",{className:"upload-panel-item-separator"},"OR"),a&&c.a.createElement("div",{className:"upload-panel-message"},a),c.a.createElement("form",{onSubmit:function(t){const a=t.target.elements.url.value.trim();if(t.preventDefault(),a){if("image"===r){const t=new Image;t.onload=()=>{e({url:a,type:r})},t.onerror=e=>{o(),console.log(e)},t.src=a}else if("audio"===r){const t=new Audio(a);t.onloadedmetadata=()=>{e({url:a,type:r})},t.onerror=e=>{o(),console.log(e)}}else if("video"===r){const t=document.createElement("video");t.crossOrigin="anonymous",t.onloadedmetadata=()=>{e({url:a,type:r})},t.onerror=e=>{o(),console.log(e)},t.src=a}}else i("Please specify valid url.")},className:"upload-panel-form"},c.a.createElement("input",{type:"text",name:"url",className:"input upload-panel-form-input",placeholder:"Enter URL..."}),c.a.createElement("button",{className:"btn upload-panel-form-btn"},"Upload"))),t&&c.a.createElement("div",{className:"create-side-message"},t))},p=(a(104),c.a.memo(({attachment:e})=>{const{blob:t,url:a,type:n}=e,l=t?URL.createObjectURL(t):a;return"image"===n?c.a.createElement("img",{src:l,alt:"",className:"create-side-image"}):"audio"===n?c.a.createElement("audio",{src:l,className:"create-side-audio",controls:!0}):"video"===n?c.a.createElement("video",{src:l,className:"create-side-video",crossOrigin:"anonymous",controls:!0}):null}));var v=function({side:e,addAttachment:t,removeAttachment:a,updateAttachmentDescription:l,handleChange:r}){var s,i;const{text:o,attachment:d}=e,[v,f]=Object(n.useState)(!o&&d?"attachment":"text");function b({target:e}){f(e.value)}return c.a.createElement("div",{className:"create-card-side"},c.a.createElement("div",{className:"create-side-toolbar"},c.a.createElement("ul",{className:"create-side-types"},c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",value:"text",checked:"text"===v,onChange:b}),c.a.createElement(m.a,{name:"text",title:"Text",className:"create-option-type-icon"}))),c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",value:"attachment",checked:"attachment"===v,onChange:b}),c.a.createElement(m.a,{name:"attachment",title:"Attachment",className:"create-option-type-icon"}))))),"text"===v?c.a.createElement("div",{className:"create-side-content create-front-side-content"},c.a.createElement("textarea",{className:"input create-side-text-input",value:o,onChange:r}),function(){const{error:t}=e;return(null==t?void 0:t.attachmentMessage)?c.a.createElement("div",{className:"create-side-message"},t.attachmentMessage):(null==t?void 0:t.textMessage)?c.a.createElement("div",{className:"create-side-message"},t.textMessage):null}()):c.a.createElement("div",{className:"create-side-content create-front-side-content"},d?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"create-side-panel"},c.a.createElement("button",{type:"button",className:"btn btn-icon create-side-panel-btn",onClick:a,title:"Remove attachment"},c.a.createElement(m.a,{name:"remove"})),c.a.createElement(p,{attachment:d}),(null==(s=e.error)?void 0:s.attachmentMessage)&&c.a.createElement("div",{className:"create-side-attachment-message"},e.error.attachmentMessage)),c.a.createElement("input",{type:"text",className:"input create-side-attachment-input",placeholder:"Describe attachment",defaultValue:d.description,onChange:l})):c.a.createElement(u,{addAttachment:t,errorMessage:null==(i=e.error)?void 0:i.textMessage})))};var f=function({side:e,updateCardBack:t}){var a;const{type:n,textOptions:l,multiOptions:r,exactOptions:s}=e;function o({target:e}){r.layout=e.value,t({multiOptions:r})}function d({target:e}){const{name:a,value:n}=e,c=r.options[a];n!==c.value&&(c.value=n,t({multiOptions:r}))}function u({target:e}){const{name:a,value:n,checked:c}=e;"caseSensitive"===a?s.caseSensitive=c:s.value=n,t({exactOptions:s})}function p(){return c.a.createElement("textarea",{className:"input create-side-text-input",value:l.value,onChange:a=>function({target:a}){const{value:n}=a;n!==e.value&&(l.value=n,t({textOptions:l}))}(a)})}function v(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"create-multi-layout"},c.a.createElement("div",{className:"create-multi-layout-title"},"Layout"),c.a.createElement("div",{onInput:o,className:"create-multi-layout-items"},c.a.createElement("label",{className:"create-multi-layout-item"},c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"multi-select",value:"short",defaultChecked:"short"===r.layout}),c.a.createElement(m.a,{name:"grid",className:"create-option-type-icon"})),c.a.createElement("label",{className:"create-multi-layout-item"},c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"multi-select",value:"medium",defaultChecked:"medium"===r.layout}),c.a.createElement(m.a,{name:"list-2-col",className:"create-option-type-icon"})),c.a.createElement("label",{className:"create-multi-layout-item"},c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"multi-select",value:"long",defaultChecked:"long"===r.layout}),c.a.createElement(m.a,{name:"menu",className:"create-option-type-icon"})))),c.a.createElement("ul",null,r.options.map(({id:e,value:a},n)=>c.a.createElement("li",{className:"create-option",key:e},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only radio-input",name:"multi-option",checked:r.correctId===e,onChange:()=>function(e){r.correctId=e,t({multiOptions:r})}(e)}),c.a.createElement("div",{className:"radio",title:"Mark answer as correct"})),c.a.createElement("input",{type:"text",className:"input create-option-input",name:n,defaultValue:a,autoComplete:"off",onChange:d}),c.a.createElement("button",{className:"btn btn-icon",title:"Remove answer",onClick:()=>{return e=n,r.options.splice(e,1),void t({multiOptions:r});var e}},c.a.createElement(m.a,{name:"remove"}))))))}return c.a.createElement("div",{className:"create-card-side"},c.a.createElement("div",{className:"create-side-toolbar"},c.a.createElement("ul",{className:"create-side-types",onChange:function({target:e}){t({type:e.value})}},c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"type-select",value:"text",defaultChecked:"text"===n}),c.a.createElement(m.a,{name:"text",title:"Text",className:"create-option-type-icon"}))),c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"type-select",value:"multi",defaultChecked:"multi"===n}),c.a.createElement(m.a,{name:"list-checkbox",title:"Multiple choice",className:"create-option-type-icon"}))),c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"type-select",value:"exact",defaultChecked:"exact"===n}),c.a.createElement(m.a,{name:"text-short",title:"Exact answer",className:"create-option-type-icon"})))),"multi"===n&&c.a.createElement("button",{className:"btn btn-icon",onClick:function(){r.options.length<8&&(r.options.push({id:Object(i.e)()}),t({multiOptions:r}))},title:"Add option",disabled:r.options.length>=8},c.a.createElement(m.a,{name:"add-list-item"}))),c.a.createElement("div",{className:"create-side-content"},function(e){return"text"===e?p():"multi"===e?v():"exact"===e?c.a.createElement("div",{onChange:u},c.a.createElement("label",{className:"create-exact-input-container"},c.a.createElement("div",{className:"create-exact-input-title"},"Provide an answer:"),c.a.createElement("input",{type:"text",className:"input create-exact-input",name:"input",autoComplete:"off",defaultValue:s.value})),c.a.createElement("label",{className:"checkbox-container create-exact-checkbox-container"},c.a.createElement("input",{type:"checkbox",className:"sr-only checkbox-input",name:"caseSensitive",defaultChecked:s.caseSensitive}),c.a.createElement("div",{className:"checkbox"},c.a.createElement("div",{className:"checkbox-tick"})),c.a.createElement("span",{className:"checkbox-label"},"Case sensitive"))):null}(n),(null==(a=e.error)?void 0:a.message)&&c.a.createElement("div",{className:"create-side-message"},e.error.message)))};function b({value:e,handleChange:t}){return c.a.createElement("div",{className:"create-card-notes-container"},c.a.createElement("textarea",{className:"input create-card-notes-input",placeholder:"Notes...",value:e,onChange:e=>t(e,"notes","value")}))}t.default=function(){const e=Object(l.f)(),t=Object(l.h)(),[a,r]=Object(n.useState)(null),[u,p]=Object(n.useState)([]),{location:E}=e;let h=0;function g(){return{id:Object(i.e)(),front:{text:""},back:{type:"text",textOptions:{value:""},multiOptions:{correctId:"",layout:"short",options:[{id:Object(i.e)()},{id:Object(i.e)()}]},exactOptions:{caseSensitive:!1,value:""}},notes:{value:""},score:{streak:0,right:0,wrong:0,total:0}}}function y(e){return e.map(e=>{const{back:t}=g();return e.back={...t,...e.back,[e.back.type+"Options"]:e.back.typeOptions},delete e.back.typeOptions,e})}function N(e,t){const n=e+t,c=a.cards;[c[e],c[n]]=[c[n],c[e]],r({...a})}function x({target:e}){const{name:t,value:n}=e;a[t]=n,"title"===t&&a.missingTitle&&delete a.missingTitle,r({...a})}function k(e){return e.attachment?!!e.attachment.description:!!e.text}function C(e){return{validOptionCount:e.options.reduce((e,{value:t})=>(t&&(e+=1),e),0),correctId:e.correctId}}function O(e){if("text"===e.type)return e.textOptions.value.length>0;if("exact"===e.type)return e.exactOptions.value.length>0;const{validOptionCount:t,correctId:a}=C(e.multiOptions);return t>1&&a}function w(t){a.title||(a.missingTitle=!0);const n=function(e){let t=0;for(const a of e){let e=0;if(a.valid=!1,a.invalid=!1,k(a.front))e+=1,delete a.front.error;else{a.front.error=a.front.error||{};const{text:e,attachment:t,error:n}=a.front;t&&!t.description?n.attachmentMessage="Please provide attachment description.":e||(n.textMessage="Please fill in the text field or provide an attachment.")}if(O(a.back))e+=1,delete a.back.error;else{a.back.error=a.back.error||{};const{type:e,textOptions:t,exactOptions:n,multiOptions:c,error:l}=a.back;if("text"!==e||t.value)if("exact"!==e||n.value){if("multi"===e){const{validOptionCount:e,correctId:t}=C(c);e<2?l.message="Please fill in at least 2 options.":t||(l.message="Please select correct option.")}}else l.message="Please provide an answer.";else l.message="Please fill in the text field."}2===e?(t+=1,a.valid=!0):a.invalid=!0}return a.globalMessage=t<2?"Please fill in at least 2 cards.":"",t===e.length}(a.cards);if(a.title&&n)if(a.cards=a.cards.map(e=>{const t={type:e.back.type,typeOptions:e.back[e.back.type+"Options"]};return e.modified&&(delete e.score,delete e.level,delete e.nextReview),delete e.modified,delete e.invalid,delete e.valid,"multi"===t.type&&(t.typeOptions.options=e.back.multiOptions.options.filter(({value:e})=>e)),e.back=t,e}),"preview"===t)e.push({pathname:`/decks/${a.id}/preview`,state:a});else{const t=Date.now();delete a.type,delete a.selectedCardIndex,a.createdAt?a.modifiedAt=t:a.createdAt=t,e.push("/decks"),Object(o.d)(a)}else r({...a})}if(Object(n.useEffect)(()=>{const{id:e}=t;if(E.state){const e=E.state;e.cards=y(e.cards),r(e),Object(i.f)("edit"===e.type?"Editing "+e.title:"Create a new deck")}else"/decks/create"===E.pathname?(r({id:Object(i.e)(),type:"create",title:"",description:"",selectedCardIndex:0,cards:[g(),g()]}),Object(i.f)("Create a new deck")):e&&Object(o.b)(e).then(e=>{e?(e.type="edit",e.makingEdit=!0,e.selectedCardIndex=0,e.cards=y(e.cards),r(e),Object(i.f)("Editing "+e.title)):r({error:!0})})},[]),Object(n.useEffect)(()=>(clearTimeout(h),u.length>0&&(h=setTimeout(()=>{p([])},8e3)),()=>{clearTimeout(h)}),[u.length]),!a)return null;if(a.error)return c.a.createElement(d.a,null);const I=a.selectedCardIndex,j=a.cards.length,A=a.cards[I];return c.a.createElement(c.a.Fragment,null,c.a.createElement("label",{className:"create-field"},c.a.createElement("div",{className:"create-field-title"},"Title"),c.a.createElement("input",{className:"input create-field-input",name:"title",value:a.title,onChange:x}),a.missingTitle&&c.a.createElement("div",{className:"create-field-input-message"},"Please provide title for your deck.")),c.a.createElement("label",{className:"create-field"},c.a.createElement("div",{className:"create-field-title"},"Description"),c.a.createElement("input",{className:"input create-field-input",name:"description",value:a.description,onChange:x})),c.a.createElement("ul",{className:"create-card-select"},a.cards.map((e,t)=>c.a.createElement("li",{className:"create-card-select-item",key:t},c.a.createElement("button",{className:`btn btn-text create-card-select-btn${t===a.selectedCardIndex?" active":""}${e.invalid?" invalid":""}${e.valid?" valid":""}`,onClick:()=>function(e){e!==a.selectedCardIndex&&r({...a,selectedCardIndex:e})}(t)},t+1))),c.a.createElement("li",{className:"create-card-select-item"},c.a.createElement("button",{onClick:function(){const e=a.cards[a.cards.length-1],t=g();t.back.type=e.back.type,"multi"===t.back.type?t.back.multiOptions.layout=e.back.multiOptions.layout:"exact"===t.back.type&&(t.back.exactOptions.caseSensitive=e.back.exactOptions.caseSensitive),r({...a,cards:[...a.cards,t]})},className:"btn btn-icon create-card-select-btn",title:"Add Card"},c.a.createElement(m.a,{name:"plus"})))),c.a.createElement("div",{className:"create-card"},c.a.createElement("div",{className:"create-card-header"},c.a.createElement("div",{className:"create-card-index-container"},c.a.createElement("button",{className:"btn btn-icon create-card-header-item",onClick:()=>N(I,-1),title:"Swap with the left card",disabled:0===I},c.a.createElement(m.a,{name:"chevron-left"})),c.a.createElement("div",{className:"create-card-index"},I+1),c.a.createElement("button",{className:"btn btn-icon create-card-header-item",onClick:()=>N(I,1),title:"Swap with the right card",disabled:I===j-1},c.a.createElement(m.a,{name:"chevron-right"}))),c.a.createElement("button",{className:"btn btn-icon",title:"Clone card",onClick:()=>function(e){const t=s()(a.cards[e]);t.id=Object(i.e)(),a.selectedCardIndex=e,a.cards.splice(e,0,t),r({...a})}(I)},c.a.createElement(m.a,{name:"clone"})),j>1&&c.a.createElement("button",{className:"btn btn-icon create-card-remove-card-btn",title:"Remove card",onClick:()=>function(e){const t=a.cards[e];(k(t.front)||O(t.back)||t.notes.value)&&p([...u,t]),a.selectedCardIndex=e>0?e-1:0,a.cards.splice(e,1),r({...a})}(I)},c.a.createElement(m.a,{name:"remove"}))),c.a.createElement("div",{className:"create-card-main",key:A.id},c.a.createElement(v,{side:A.front,addAttachment:function(e){const t=a.cards[a.selectedCardIndex];t.modified=!0,t.front.attachment=e,delete t.front.error,r({...a})},removeAttachment:function(){const e=a.cards[a.selectedCardIndex];e.modified=!0,delete e.front.attachment,delete e.front.error,r({...a})},updateAttachmentDescription:function({target:e}){var t;const n=a.cards[a.selectedCardIndex];n.modified=!0,n.front.attachment.description=e.value,(null==(t=n.front.error)?void 0:t.attachmentMessage)&&delete n.front.error,r({...a})},handleChange:function({target:e}){const{value:t}=e,n=a.cards[a.selectedCardIndex];var c;t!==n.front.text&&(n.front.text=t,n.modified=!0,(null==(c=n.front.error)?void 0:c.textMessage)&&delete n.front.error.textMessage,r({...a}))}}),c.a.createElement(f,{side:A.back,updateCardBack:function(e){const t=a.cards[a.selectedCardIndex];t.modified=!0,t.back={...t.back,...e},delete t.back.error,r({...a})}})),c.a.createElement(b,{value:A.notes.value,handleChange:function({target:e}){const{value:t}=e,n=a.cards[a.selectedCardIndex];t!==n.notes.value&&(n.notes.value=t,r({...a}))}})),u.length>0&&c.a.createElement("div",{className:"create-undo-dialog"},c.a.createElement("span",null,"Removed ",u.length," card",u.length>1?"s":""),c.a.createElement("button",{className:"btn btn-text create-dialog-undo-btn",onClick:function(){p([]),r({...a,cards:a.cards.concat(u)})}},"UNDO")),c.a.createElement("div",{className:"create-footer"},a.globalMessage&&c.a.createElement("span",{className:"create-message"},a.globalMessage),c.a.createElement("button",{className:"btn create-footer-btn",onClick:function(){w("preview")}},"Preview"),c.a.createElement("button",{className:"btn create-footer-btn",onClick:w},a.makingEdit?"Update":"Create")))}},98:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return s}));const n=new(a(99).a)("nimus-cards");function c(){return n.decks.toArray().then(i).catch(e=>{console.log(e)})}function l(e){return n.decks.get(e)}function r(e){n.decks.put(e).catch(e=>{console.log(e)})}function s(e){n.decks.delete(e).catch(e=>{console.log(e)})}function i(e){return e.sort((e,t)=>e.createdAt<t.createdAt?1:e.createdAt>t.createdAt?-1:0)}n.version(1).stores({decks:"id"})}}]);