(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{100:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return i}));var n=a(101),c=a.n(n);let s=JSON.parse(localStorage.getItem("nimus-cards-settings"))||{randomize:{value:!0},cardCount:{value:10},timeoutDuration:{value:""}};function l(){return c()(s)}function i(e){s={...s,...e},localStorage.setItem("nimus-cards-settings",JSON.stringify(s))}},102:function(e,t,a){"use strict";var n=a(0),c=a.n(n);a(103);t.a=function({className:e,hide:t,children:a}){const s=Object(n.useCallback)((function({key:e}){"Escape"===e&&t()}),[]);return Object(n.useEffect)(()=>(window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}),[]),c.a.createElement("div",{className:"modal-mask",onClick:function({target:e,currentTarget:a}){e===a&&t()}},c.a.createElement("div",{className:"modal"+(e?" "+e:"")},a))}},103:function(e,t,a){},112:function(e,t,a){},114:function(e,t,a){},115:function(e,t,a){},153:function(e,t,a){"use strict";a.r(t);a(30);var n=a(0),c=a.n(n),s=a(8),l=(a(112),a(31)),i=a(98),r=a(9),o=a(102);function d({removeDeck:e,cancelRemoval:t}){return c.a.createElement(o.a,{hide:t},c.a.createElement("h3",{className:"modal-title"},"Are you sure you want to remove this deck?"),c.a.createElement("div",{className:"deck-remove-modal-footer"},c.a.createElement("button",{className:"btn btn-text deck-remove-modal-cancel-btn",onClick:t},"Cancel"),c.a.createElement("button",{className:"btn btn-negative btn-negative-text deck-remove-modal-confirm-btn",onClick:e},"Remove")))}var m=a(100);a(114);var u=function({children:e,hide:t}){return c.a.createElement(o.a,{hide:t},e,c.a.createElement("div",{className:"decks-settings-footer"},c.a.createElement("button",{className:"btn btn-text decks-settings-hide-btn",onClick:t},"Close")))};var b=function({hide:e}){const[t,a]=Object(n.useState)(Object(m.a)());function s({target:e}){const n=e.getAttribute("data-name"),c={...t[n]};switch(e.type){case"checkbox":c.value=e.checked;break;case"text":c.valid=e.validity.valid,c.value=e.value}a({...t,[n]:c})}return c.a.createElement(u,{hide:function(){const a=Object(m.a)(),{cardCount:n,timeoutDuration:c}=t;n.valid&&(a.cardCount.value=parseInt(n.value,10)||0),c.valid&&(a.timeoutDuration.value=parseInt(c.value,10)||0),a.randomize=t.randomize,Object(m.b)(a),e()}},c.a.createElement("h3",{className:"modal-title"},"Global Deck Settings"),c.a.createElement("div",{className:"decks-settings-item"},c.a.createElement("label",{className:"checkbox-container"},c.a.createElement("input",{type:"checkbox",className:"sr-only checkbox-input","data-name":"randomize",onChange:s,checked:t.randomize.value}),c.a.createElement("div",{className:"checkbox decks-settings-checkbox"},c.a.createElement("div",{className:"checkbox-tick"})),c.a.createElement("span",{className:"checkbox-label"},"Randomize cards"))),c.a.createElement("div",{className:"decks-settings-item"},c.a.createElement("label",null,c.a.createElement("span",null,"Use"),c.a.createElement("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"cardCount",onChange:s,pattern:"[0-9]*$",value:t.cardCount.value}),c.a.createElement("span",null,"cards per study session"),c.a.createElement("div",{className:"decks-settings-message"},"Please provide a valid whole number."))),c.a.createElement("div",{className:"decks-settings-item"},c.a.createElement("label",null,c.a.createElement("span",null,"Reveal answer after"),c.a.createElement("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"timeoutDuration",onChange:s,pattern:"^0*|0*([5-9][0-9]*|[1-9]+[0-9]+)$",value:t.timeoutDuration.value}),c.a.createElement("span",null,"seconds"),c.a.createElement("div",{className:"decks-settings-message"},"Please provide a valid whole number.",c.a.createElement("br",null)," Minimal accepted value is 5 seconds."))))},k=a(101),v=a.n(k);var p=function({deck:e,hide:t}){const a=e.settings||{...Object(m.a)(),useGlobalSettings:{value:!0}},[s,l]=Object(n.useState)(v()(a)),r=s.useGlobalSettings.value;function o({target:e}){const t=e.getAttribute("data-name"),a={...s[t]};switch(e.type){case"checkbox":a.value=e.checked;break;case"text":a.valid=e.validity.valid,a.value=e.value}l({...s,[t]:a})}return c.a.createElement(u,{hide:function(){const{cardCount:n,timeoutDuration:c}=s;n.valid&&(a.cardCount.value=parseInt(n.value,10)||0),c.valid&&(a.timeoutDuration.value=parseInt(c.value,10)||0),a.useGlobalSettings=s.useGlobalSettings,a.randomize=s.randomize,e.settings=a,Object(i.d)(e),t()}},c.a.createElement("h3",{className:"modal-title"},"Deck Settings"),c.a.createElement("div",{className:"decks-settings-item"},c.a.createElement("label",{className:"checkbox-container"},c.a.createElement("input",{type:"checkbox",className:"sr-only checkbox-input","data-name":"useGlobalSettings",onChange:o,defaultChecked:r}),c.a.createElement("div",{className:"checkbox decks-settings-checkbox"},c.a.createElement("div",{className:"checkbox-tick"})),c.a.createElement("span",{className:"checkbox-label"},"Use global settings"))),c.a.createElement("div",{className:"decks-settings-item"+(r?" disabled":"")},c.a.createElement("label",{className:"checkbox-container"},c.a.createElement("input",{type:"checkbox",className:"sr-only checkbox-input","data-name":"randomize",onChange:o,defaultChecked:s.randomize.value,disabled:r}),c.a.createElement("div",{className:"checkbox decks-settings-checkbox"},c.a.createElement("div",{className:"checkbox-tick"})),c.a.createElement("span",{className:"checkbox-label"},"Randomize cards"))),c.a.createElement("div",{className:"decks-settings-item"+(r?" disabled":"")},c.a.createElement("label",null,c.a.createElement("span",null,"Use"),c.a.createElement("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"cardCount",pattern:"[0-9]*$",onChange:o,defaultValue:s.cardCount.value,disabled:r}),c.a.createElement("span",null,"cards per study session"),c.a.createElement("div",{className:"decks-settings-message"},"Please provide a valid whole number."))),c.a.createElement("div",{className:"decks-settings-item"+(r?" disabled":"")},c.a.createElement("label",null,c.a.createElement("span",null,"Reveal answer after"),c.a.createElement("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"timeoutDuration",pattern:"^0*|0*([5-9][0-9]*|[1-9]+[0-9]+)$",onChange:o,defaultValue:s.timeoutDuration.value,disabled:r}),c.a.createElement("span",null,"seconds"),c.a.createElement("div",{className:"decks-settings-message"},"Please provide a valid whole number.",c.a.createElement("br",null)," Minimal accepted value is 5 seconds."))))};a(115);var E=function({children:e}){const[{id:t,visible:a},s]=Object(n.useState)({id:"",visible:!1}),i=Object(n.useCallback)((function({target:e}){const a=e.closest(".dropdown-container");let n=!0;a&&a.id===t&&(n=e.closest(".dropdown-btn"));n&&(o.current&&s({id:t,visible:!1}),window.removeEventListener("click",i))}),[t]),o=Object(n.useRef)(!1);return Object(n.useEffect)(()=>(o.current=!0,s({visible:a,id:Object(l.e)()}),()=>{o.current=!1,window.removeEventListener("click",i)}),[]),c.a.createElement("div",{id:t,className:"dropdown-container"},c.a.createElement("button",{className:"btn btn-icon",onClick:function(){a?window.removeEventListener("click",i):window.addEventListener("click",i),s({id:t,visible:!a})}},c.a.createElement(r.a,{name:"dots-vertical"})),a&&c.a.createElement("div",{className:"dropdown"},e))};function f({deck:e,showDialog:t,showDeckSettings:a,exportDeck:n}){return c.a.createElement("li",{className:"deck"},c.a.createElement("div",{className:"deck-body"},c.a.createElement("div",null,c.a.createElement("h2",{className:"deck-title"},e.title),e.description&&c.a.createElement("p",{className:"deck-description"},e.description),c.a.createElement("div",{className:"deck-info"},c.a.createElement("div",{className:"deck-info-item"},e.cards.length," card",e.cards.length>1&&"s"),c.a.createElement("div",{className:"deck-info-item"},function(){const t=e.modifiedAt?"Modified":"Created",a=Date.now()-(e.modifiedAt||e.createdAt),n=864e5;if(a<6e4)return t+" just now";const c=function(e,t){return(a,n)=>{const c=Math.round(e/n);return`${t} ${c} ${a}${c>1?"s":""} ago`}}(a,t);return a<36e5?c("minute",6e4):a<n?c("hour",36e5):a<2592e6?c("day",n):a<315576e5?c("month",2592e6):c("year",315576e5)}()))),c.a.createElement(E,null,c.a.createElement("button",{className:"btn btn-icon-text dropdown-btn",onClick:()=>a(e)},c.a.createElement(r.a,{name:"settings"}),c.a.createElement("span",null,"Settings")),c.a.createElement(s.b,{to:"/decks/"+e.id,className:"btn btn-icon-text dropdown-btn"},c.a.createElement(r.a,{name:"list"}),c.a.createElement("span",null,"Status")),c.a.createElement(s.b,{to:`/decks/${e.id}/edit`,className:"btn btn-icon-text dropdown-btn"},c.a.createElement(r.a,{name:"edit"}),c.a.createElement("span",null,"Edit")),c.a.createElement("button",{className:"btn btn-icon-text dropdown-btn",onClick:()=>n(e)},c.a.createElement(r.a,{name:"export"}),c.a.createElement("span",null,"Export")),c.a.createElement("button",{className:"btn btn-icon-text dropdown-btn",onClick:()=>t(e.id)},c.a.createElement(r.a,{name:"remove"}),c.a.createElement("span",null,"Remove")))),c.a.createElement("div",{className:"deck-btn-container"},e.hasCardsToLearn?c.a.createElement(s.b,{to:`/decks/${e.id}/learn`,className:"btn btn-text deck-btn"},"Learn"):c.a.createElement("span",{className:"btn btn-text deck-btn disabled"},"Learn"),e.hasCardsToReview?c.a.createElement(s.b,{to:`/decks/${e.id}/review`,className:"btn btn-text deck-btn"},"Review"):c.a.createElement("span",{className:"btn btn-text deck-btn disabled"},"Review"),c.a.createElement(s.b,{to:`/decks/${e.id}/practice`,className:"btn btn-text deck-btn"},"Practice")))}t.default=function(){const[e,t]=Object(n.useState)([]),[o,m]=Object(n.useState)({visible:!1}),[u,k]=Object(n.useState)(!0);function v(e){m({deckRemoveModalVisible:!0,id:e})}function E(e){m({deckSettingsVisible:!0,deck:e})}function h(){m({})}async function g(e){const[{saveAs:t},{default:n}]=await Promise.all([a.e(10).then(a.t.bind(null,150,7)),a.e(3).then(a.t.bind(null,151,7))]),c=new n,s=c.folder(e.title);s.file("metadata.json",JSON.stringify({title:e.title,description:e.description},null,2)),e.cards.forEach((e,t)=>{const a=e.front.attachment;let n=void 0;a&&(a.blob?(n={type:a.type,description:a.description,mimeType:a.blob.type,blobName:a.blob.name},s.file(a.blob.name,new Blob([a.blob],{type:a.blob.type}))):n=a),s.file(t+".json",JSON.stringify({...e,front:{...e.front,attachment:n}},null,2))});t(await c.generateAsync({type:"blob"}),e.title+".zip")}return Object(n.useEffect)(()=>{Object(i.c)().then(e=>{t(e.map(e=>(e.hasCardsToLearn=!!Object(l.c)(e.cards).length,e.hasCardsToReview=!!Object(l.d)(e.cards).length,e))),k(!1),Object(l.f)("Your decks")})},[]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"decks-header"},c.a.createElement("h1",{className:"decks-title"},"Your Decks"),c.a.createElement(s.b,{to:"/decks/create",className:"btn deck-create-link"},"Create")),c.a.createElement("div",{className:"decks-top-bar"},c.a.createElement("label",{className:"btn btn-icon-text decks-top-bar-item deck-import-input-container"},c.a.createElement(r.a,{name:"import"}),c.a.createElement("span",null,"Import"),c.a.createElement("input",{type:"file",className:"sr-only",onChange:async function({target:n}){const[c]=n.files,{default:s}=await a.e(3).then(a.t.bind(null,151,7)),r=await s.loadAsync(c),o={id:Object(l.e)(),title:"",description:"",createdAt:Date.now(),cards:[]};for(const[e,t]of Object.entries(r.files))if(e.endsWith("/metadata.json")){const e=JSON.parse(await t.async("string"));Object.assign(o,e)}else if(e.endsWith(".json")){const e=JSON.parse(await t.async("string")),a=e.front.attachment;if(e.id=Object(l.e)(),a&&a.blobName){const{blobName:e}=a,t=r.files[`${o.title}/${e}`];a.blob=new File([await t.async("blob")],e,{type:a.mimeType}),delete a.blobName,delete a.mimeType}o.cards.push(e)}t([...e,o]),Object(i.d)(o),n.value=""}})),c.a.createElement("button",{className:"btn btn-icon-text decks-top-bar-item",onClick:function(){m({settingsVisible:!0})}},c.a.createElement(r.a,{name:"settings"}),c.a.createElement("span",null,"Settings"))),u?"":e.length?c.a.createElement("ul",{className:"decks"},function(e){return e.map(e=>c.a.createElement(f,{key:e.id,deck:e,showDialog:v,showDeckSettings:E,exportDeck:g}))}(e)):c.a.createElement("h2",{className:"decks-message"},"You have no decks"),o.deckRemoveModalVisible&&c.a.createElement(d,{removeDeck:function(){const a=function(e,t){return e.findIndex(({id:e})=>e===t)}(e,o.id);e.splice(a,1),t([...e]),Object(i.a)(o.id),h()},cancelRemoval:h}),o.settingsVisible&&c.a.createElement(b,{hide:h}),o.deckSettingsVisible&&c.a.createElement(p,{hide:h,deck:o.deck}))}},98:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return i}));const n=new(a(99).a)("nimus-cards");function c(){return n.decks.toArray().then(r).catch(e=>{console.log(e)})}function s(e){return n.decks.get(e)}function l(e){n.decks.put(e).catch(e=>{console.log(e)})}function i(e){n.decks.delete(e).catch(e=>{console.log(e)})}function r(e){return e.sort((e,t)=>e.createdAt<t.createdAt?1:e.createdAt>t.createdAt?-1:0)}n.version(1).stores({decks:"id"})}}]);