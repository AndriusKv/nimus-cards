(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{100:function(e,t,a){},114:function(e,t,a){},115:function(e,t,a){},146:function(e,t,a){"use strict";a.r(t);a(56);var n=a(0),c=a.n(n),l=(a(114),a(30));const i=Object(n.createContext)(null);function r({children:e}){const[t,a]=Object(n.useReducer)(s,null),l=Object(n.useMemo)(()=>({state:t,dispatch:a}),[t]);return c.a.createElement(i.Provider,{value:l},e)}function o(){return Object(n.useContext)(i)}function s(e,t){switch(t.type){case"RESET_DECK":return{...t.deck};case"UPDATE_DECK":return{...e,[t.name]:t.value};case"ADD_CARD":return{...e,cards:[...e.cards,t.card]};case"REMOVE_CARD":return e.cards.splice(t.index,1),{...e};case"UPDATE_CARD_VALUE":return e.cards[t.index].modified="front"===t.name,e.cards[t.index][t.name][t.key]=t.value,{...e};case"ADD_ATTACHMENT":return e.cards[t.index].modified=!0,e.cards[t.index].front.attachment=t.attachment,{...e};case"REMOVE_ATTACHMENT":return e.cards[t.index].modified=!0,delete e.cards[t.index].front.attachment,{...e};case"UPDATE_ATTACHMENT_DESCRIPTION":return e.cards[t.index].modified=!0,e.cards[t.index].front.attachment.description=t.description,{...e};case"UPDATE_CARD_BACK":const a=e.cards[t.index];return a.modified=!0,a.back={...a.back,...t.payload},{...e};default:return e}}var m=a(99),u=a(11);function d({textSize:e,handleChange:t}){return c.a.createElement("select",{className:"input create-side-select",title:"Text size",defaultValue:e,onChange:t},c.a.createElement("option",{value:"16"},"16px"),c.a.createElement("option",{value:"24"},"24px"),c.a.createElement("option",{value:"36"},"36px"),c.a.createElement("option",{value:"48"},"48px"))}a(115);var p=a(98);var E=function({hide:e,addAttachment:t}){const[a,l]=Object(n.useState)(""),[i,r]=Object(n.useState)("");function o(e){l(e),setTimeout(()=>{l("")},3200)}return c.a.createElement(p.a,{className:"upload-panel",hide:e},c.a.createElement("h3",{className:"modal-title"},"Add Attachment"),c.a.createElement("div",{className:"upload-type-selection"},["image","audio","video"].map((e,t)=>c.a.createElement("button",{className:"btn btn-icon upload-type-selection-btn"+(i===e?" active":""),onClick:()=>r(e),key:t},c.a.createElement(u.a,{name:e+"-file"}),c.a.createElement("span",null,e)))),i&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"upload-panel-device-target"},c.a.createElement("div",{className:"upload-panel-device-target-title"},"Select ",i," file from device"),c.a.createElement("label",{className:"btn upload-panel-import-input-container"},c.a.createElement("span",null,"Select File"),c.a.createElement("input",{type:"file",className:"sr-only",onChange:function({target:e}){const[a]=e.files;e.value="",a.type.split("/")[0]!==i?o("File is not an "+i):t({blob:a,type:i})}}))),c.a.createElement("div",{className:"upload-panel-item-separator"},"Or"),c.a.createElement("div",{className:"upload-panel-url-target"},c.a.createElement("div",{className:"upload-panel-url-target-title"},"Upload ",i," file from URL"),c.a.createElement("form",{onSubmit:function(e){const a=e.target.elements.url.value.trim();if(e.preventDefault(),a){if("image"===i){const e=new Image;e.onload=()=>{t({url:a,type:i})},e.onerror=e=>{o(`URL doesn't contain ${i} file`),console.log(e)},e.src=a}else if("audio"===i){const e=new Audio(a);e.onloadedmetadata=()=>{t({url:a,type:i})},e.onerror=e=>{o(`URL doesn't contain ${i} file`),console.log(e)}}else if("video"===i){const e=document.createElement("video");e.crossOrigin="anonymous",e.onloadedmetadata=()=>{t({url:a,type:i})},e.onerror=e=>{o(`URL doesn't contain ${i} file`),console.log(e)},e.src=a}}else o("Please specify valid url")},className:"upload-panel-form"},c.a.createElement("input",{type:"text",name:"url",className:"input upload-panel-url-target-input"}),c.a.createElement("button",{className:"btn"},"Upload"))),c.a.createElement("div",{className:"upload-panel-footer"},a&&c.a.createElement("div",{className:"upload-panel-message"},a),c.a.createElement("button",{type:"button",className:"btn btn-text",onClick:e},"Cancel"))))};a(103);function f({blob:e,url:t,type:a}){const n=e?URL.createObjectURL(e):t;return"image"===a?c.a.createElement("img",{src:n,alt:"",className:"create-side-image"}):"audio"===a?c.a.createElement("audio",{src:n,className:"create-side-audio",controls:!0}):"video"===a?c.a.createElement("video",{src:n,className:"create-side-video",crossOrigin:"anonymous",controls:!0}):null}var v=function({index:e,side:t,handleChange:a}){const{dispatch:l}=o(),[i,r]=Object(n.useState)(!1),{text:s,textSize:m,attachment:p}=t;function v(){l({type:"REMOVE_ATTACHMENT",index:e})}function b(){r(!1)}return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,c.a.createElement("div",{className:"deck-form-field-title"},"FRONT"),c.a.createElement("div",{className:"create-side-toolbar"},c.a.createElement("button",{className:"btn btn-icon toolbar-btn",title:"Add attachment",onClick:function(){r(!0)}},c.a.createElement(u.a,{name:"add-file"})),c.a.createElement(d,{textSize:m,handleChange:e=>a(e,"front","textSize")})),c.a.createElement("div",{className:"create-side-content"},p&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"create-side-panel"},c.a.createElement("button",{type:"button",className:"btn btn-icon create-side-panel-btn",onClick:v,title:"Remove attachment"},c.a.createElement(u.a,{name:"remove"})),c.a.createElement(f,p)),c.a.createElement("input",{type:"text",className:"input create-side-attachment-input",placeholder:"Describe attachment",defaultValue:p.description,onChange:function({target:t}){l({type:"UPDATE_ATTACHMENT_DESCRIPTION",index:e,description:t.value})}})),c.a.createElement("textarea",{className:"input create-side-text-input",value:s,style:{fontSize:m+"px"},onChange:e=>a(e,"front","text")}))),i&&c.a.createElement(E,{hide:b,addAttachment:function(t){l({type:"ADD_ATTACHMENT",index:e,attachment:t}),b()}}))};var b=function({index:e}){const{state:t,dispatch:a}=o(),{back:n,id:i}=t.cards[e],{type:r,textOptions:s,multiOptions:m,exactOptions:p}=n;function E(t){a({type:"UPDATE_CARD_BACK",index:e,payload:t})}function f({target:e},t){const{value:a}=e;a!==n[t]&&(s[t]=a,E({textOptions:s}))}function v({target:e}){m.layout=e.value,E({multiOptions:m})}function b({target:e}){const{name:t,value:a}=e,n=m.options[t];a!==n.value&&(n.value=a,E({multiOptions:m}))}function y({target:e}){const{name:t,value:a,checked:n}=e;"caseSensitive"===t?p.caseSensitive=n:p.value=a,E({exactOptions:p})}function N(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"create-multi-layout"},c.a.createElement("div",{className:"create-multi-layout-title"},"Layout"),c.a.createElement("div",{onInput:v,className:"create-multi-layout-items"},c.a.createElement("label",{className:"create-multi-layout-item"},c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"multi-"+i,value:"short",defaultChecked:"short"===m.layout}),c.a.createElement(u.a,{name:"grid",className:"create-option-type-icon"})),c.a.createElement("label",{className:"create-multi-layout-item"},c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"multi-"+i,value:"medium",defaultChecked:"medium"===m.layout}),c.a.createElement(u.a,{name:"list-2-col",className:"create-option-type-icon"})),c.a.createElement("label",{className:"create-multi-layout-item"},c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"multi-"+i,value:"long",defaultChecked:"long"===m.layout}),c.a.createElement(u.a,{name:"menu",className:"create-option-type-icon"})))),c.a.createElement("ul",null,m.options.map(({id:e,value:t},a)=>c.a.createElement("li",{className:"create-option",key:e},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only radio-input",name:i,checked:m.correctId===e,onChange:()=>function(e){m.correctId=e,E({multiOptions:m})}(e)}),c.a.createElement("div",{className:"radio create-option-radio",title:"Mark answer as correct"})),c.a.createElement("input",{type:"text",className:"input create-option-input",name:a,defaultValue:t,autoComplete:"off",onChange:b}),c.a.createElement("button",{className:"btn btn-icon",title:"Remove answer",onClick:()=>{return e=a,m.options.splice(e,1),void E({multiOptions:m});var e}},c.a.createElement(u.a,{name:"remove"}))))))}return c.a.createElement("div",null,c.a.createElement("div",{className:"deck-form-field-title"},"BACK"),c.a.createElement("div",{className:"create-side-toolbar"},c.a.createElement("ul",{className:"create-side-types",onChange:function({target:e}){E({type:e.value})}},c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"type-"+i,value:"text",defaultChecked:"text"===r}),c.a.createElement(u.a,{name:"text",title:"Text",className:"create-option-type-icon"}))),c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"type-"+i,value:"multi",defaultChecked:"multi"===r}),c.a.createElement(u.a,{name:"list-checkbox",title:"Multiple choice",className:"create-option-type-icon"}))),c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"sr-only create-type-radio",name:"type-"+i,value:"exact",defaultChecked:"exact"===r}),c.a.createElement(u.a,{name:"text-short",title:"Exact answer",className:"create-option-type-icon"})))),"text"===r&&c.a.createElement(d,{textSize:s.textSize,handleChange:e=>f(e,"textSize")}),"multi"===r&&c.a.createElement("button",{className:"btn btn-icon",onClick:function(){m.options.length<8&&(m.options.push({id:Object(l.d)()}),E({multiOptions:m}))},title:"Add option",disabled:m.options.length>=8},c.a.createElement(u.a,{name:"add-list-item"}))),c.a.createElement("div",{className:"create-side-content"},function(e){return"text"===e?c.a.createElement("textarea",{className:"input create-side-text-input",value:s.value,style:{fontSize:s.textSize+"px"},onChange:e=>f(e,"value")}):"multi"===e?N():"exact"===e?c.a.createElement("div",{onChange:y},c.a.createElement("label",{className:"creact-exact-input-container"},c.a.createElement("div",{className:"creact-exact-input-title"},"Provide answer:"),c.a.createElement("input",{type:"text",className:"input creact-exact-input",name:"input",autoComplete:"off",defaultValue:p.value})),c.a.createElement("label",{className:"checkbox-container creact-exact-checkbox-container"},c.a.createElement("input",{type:"checkbox",className:"sr-only checkbox-input",name:"caseSensitive",defaultChecked:p.caseSensitive}),c.a.createElement("div",{className:"checkbox create-checkbox"},c.a.createElement("div",{className:"checkbox-tick"})),c.a.createElement("span",{className:"checkbox-label"},"Case sensitive"))):null}(r)))};function y({value:e,handleChange:t}){return c.a.createElement("div",{className:"deck-form-card-notes-container"},c.a.createElement("div",{className:"deck-form-field-title"},"NOTES"),c.a.createElement("textarea",{className:"input deck-form-card-notes-input",value:e,onChange:e=>t(e,"notes","value")}))}var N=function({index:e,card:t,removeCard:a}){const{state:l,dispatch:i}=o(),[r,s]=Object(n.useState)(t.notes&&!!t.notes.value);function m({target:a},n,c){const{value:l}=a;l!==t[n][c]&&i({type:"UPDATE_CARD_VALUE",index:e,name:n,key:c,value:l})}return c.a.createElement("li",{className:"create-list-item"},c.a.createElement("div",{className:"create-card-index"},e+1,"."),c.a.createElement("div",{className:"deck-form-field-group create-card"},c.a.createElement(v,{index:e,side:t.front,handleChange:m}),c.a.createElement(b,{index:e}),r&&c.a.createElement(y,{value:t.notes.value,handleChange:m})),c.a.createElement("div",{className:"create-card-btns"},c.a.createElement("button",{className:"btn btn-icon",title:"Toggle notes",onClick:function(){s(!r)}},c.a.createElement(u.a,{name:"notes"})),l.cards.length>1&&c.a.createElement("button",{className:"btn btn-icon",title:"Remove card",onClick:()=>a(e)},c.a.createElement(u.a,{name:"remove"}))))};function x(e){const{state:t,dispatch:a}=o(),[i,r]=Object(n.useState)(""),[s,u]=Object(n.useState)([]),d=Object(n.useRef)();let p=0,E=0;function f(){return{id:Object(l.d)(),front:{text:"",textSize:16},back:{type:"text",textOptions:{value:"",textSize:16},multiOptions:{correctId:"",layout:"short",options:[{id:Object(l.d)()},{id:Object(l.d)()}]},exactOptions:{caseSensitive:!1,value:""}},notes:{value:""}}}function v(e){const n=t.cards[e];(b(n.front)||y(n.back)||n.notes.value)&&u([...s,n]),a({type:"REMOVE_CARD",index:e})}function b(e){return e.attachment?!!e.attachment.description:!!e.text}function y(e,t=!1){if("text"===e.type)return e.textOptions.value.length>0;if("exact"===e.type)return e.exactOptions.value.length>0;const a=e.multiOptions.options.reduce((e,{value:t})=>(t&&(e+=1),e),0);return t?a>0:a>1&&e.multiOptions.correctId}function x({target:e}){const{name:t,value:n}=e;a({type:"UPDATE_DECK",name:t,value:n})}return Object(n.useEffect)(()=>{const{id:t}=e.match.params;"/decks/create"===e.match.path?(a({type:"RESET_DECK",deck:{id:Object(l.d)(),title:"",description:"",cards:[f(),f()]}}),Object(l.e)("Create a new deck")):t&&Object(m.b)(t).then(e=>{e&&(e.cards=e.cards.map(e=>(e.back={...f().back,...e.back,type:e.back.type,[e.back.type+"Options"]:e.back.typeOptions},delete e.back.typeOptions,e)),a({type:"RESET_DECK",deck:e}),Object(l.e)("Editing "+e.title))})},[]),Object(n.useEffect)(()=>(clearTimeout(p),p=setTimeout(()=>{r("")},3200),()=>{clearTimeout(p)}),[i]),Object(n.useEffect)(()=>(clearTimeout(E),s.length>0&&(E=setTimeout(()=>{u([])},8e3)),()=>{clearTimeout(E)}),[s.length]),t?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"deck-form-field-group create-input-group"},c.a.createElement("label",{className:"deck-form-title-input-container"},c.a.createElement("div",{className:"deck-form-field-title"},"TITLE"),c.a.createElement("input",{className:"input create-title-input",name:"title",value:t.title,onChange:x})),c.a.createElement("label",{className:"deck-form-desc-input-container"},c.a.createElement("div",{className:"deck-form-field-title"},"DESCRIPTION (OPTIONAL)"),c.a.createElement("textarea",{className:"input create-description-input",name:"description",value:t.description,onChange:x}))),c.a.createElement("ul",null,t.cards.map((e,t)=>c.a.createElement(N,{key:e.id,index:t,card:e,removeCard:v}))),s.length>0&&c.a.createElement("div",{className:"deck-form-dialog"},c.a.createElement("span",null,"Removed ",s.length," card",s.length>1?"s":""),c.a.createElement("button",{className:"btn btn-text",onClick:function(){clearTimeout(E),u([]),a({type:"RESET_DECK",deck:{...t,cards:t.cards.concat(s)}})}},"UNDO")),c.a.createElement("div",{className:"create-footer"},c.a.createElement("button",{className:"btn",onClick:function(){const e=t.cards[t.cards.length-1],n=f();n.front.textSize=e.front.textSize,n.back.type=e.back.type,"text"===n.back.type?n.back.textOptions.textSize=e.back.textOptions.textSize:"multi"===n.back.type?n.back.multiOptions.layout=e.back.multiOptions.layout:"exact"===n.back.type&&(n.back.exactOptions.caseSensitive=e.back.exactOptions.caseSensitive),a({type:"ADD_CARD",card:n}),requestAnimationFrame(()=>{d.current.scrollIntoView()})},ref:d},"New Card"),i&&c.a.createElement("span",{className:"create-message"},i),c.a.createElement("button",{className:"btn",onClick:function(){if(!t.title)return void r("Title is required");const a=function(e){return e.filter(e=>b(e.front)||y(e.back,!0))}(t.cards);(function(e){let t=0;for(const{front:a,back:n}of e)b(a)&&y(n)&&(t+=1);if(t!==e.length)r("Please fill in both card sides");else{if(!(t<2))return!0;r("Please fill in at least two cards")}})(a)&&(t.cards=function(e){return e.map(e=>{const t={type:e.back.type,typeOptions:e.back[e.back.type+"Options"]};return e.modified&&(delete e.score,delete e.level,delete e.nextReview),delete e.modified,"multi"===t.type&&(t.typeOptions.options=e.back.multiOptions.options.filter(({value:e})=>e)),e.back=t,e})}(a),t.createdAt=t.createdAt||new Date,e.history.push("/decks"),Object(m.d)(t))}},"Create"))):null}t.default=function(e){return c.a.createElement(r,null,c.a.createElement(x,e))}},98:function(e,t,a){"use strict";var n=a(0),c=a.n(n);a(100);t.a=function({className:e,hide:t,children:a}){const l=Object(n.useCallback)((function({key:e}){"Escape"===e&&t()}),[]);return Object(n.useEffect)(()=>(window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}),[]),c.a.createElement("div",{className:"modal-mask",onClick:function({target:e,currentTarget:a}){e===a&&t()}},c.a.createElement("div",{className:"modal"+(e?" "+e:"")},a))}},99:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return r}));const n=new(a(101).a)("nimus-cards");function c(){return n.decks.toArray().then(o).catch(e=>{console.log(e)})}function l(e){return n.decks.get(e)}function i(e){n.decks.put(e).catch(e=>{console.log(e)})}function r(e){n.decks.delete(e).catch(e=>{console.log(e)})}function o(e){return e.sort((e,t)=>{const a=new Date(e.createdAt||0),n=new Date(t.createdAt||0);return a<n?1:a>n?-1:0})}n.version(1).stores({decks:"id"})}}]);