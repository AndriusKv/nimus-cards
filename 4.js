(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{102:function(e,t,a){"use strict";a.d(t,"b",function(){return c}),a.d(t,"c",function(){return i}),a.d(t,"a",function(){return l});const n=new(a(105).a)("nimus-cards-decks");function c(){return n.decks.toArray().catch(e=>{console.log(e)})}function i(e){n.decks.put(e).catch(e=>{console.log(e)})}function l(e){n.decks.delete(e).catch(e=>{console.log(e)})}n.version(1).stores({decks:"++_id"})},104:function(e,t,a){"use strict";a.d(t,"b",function(){return n}),a.d(t,"a",function(){return c});a(127);function n(e){const t=[].concat(e);let a=t.length;for(;a;){const e=Math.floor(Math.random()*a);a-=1;var n=[t[e],t[a]];t[a]=n[0],t[e]=n[1]}return t}function c(){return Math.random().toString(32).slice(2,10)}},106:function(e,t,a){"use strict";var n=a(15),c=a(11),i=a(12),l=a(18).f,r=a(57),s=a(1).Symbol;if(n&&"function"==typeof s&&(!("description"in s.prototype)||void 0!==s().description)){var o={},u=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof u?new s(e):void 0===e?s():s(e);return""===e&&(o[t]=!0),t};r(u,s);var d=u.prototype=s.prototype;d.constructor=u;var m=d.toString,p="Symbol(test)"==String(s("test")),f=/^Symbol\((.*)\)[^)]+$/;l(d,"description",{configurable:!0,get:function(){var e=i(this)?this.valueOf():this,t=m.call(e);if(c(o,e))return"";var a=p?t.slice(7,-1):t.replace(f,"$1");return""===a?void 0:a}}),a(52)({global:!0,forced:!0},{Symbol:u})}},112:function(e,t,a){"use strict";a.d(t,"a",function(){return i});a(101),a(113);var n=a(0),c=a.n(n);function i(e){let t=e.file,a=e.type;const n="string"==typeof t?t:URL.createObjectURL(t);return"image"===a?c.a.createElement("img",{src:n,alt:"",className:"side-image"}):"audio"===a?c.a.createElement("audio",{src:n,className:"side-audio",controls:!0}):null}},125:function(e,t,a){"use strict";var n=a(138),c=a(139)("trim");a(52)({target:"String",proto:!0,forced:c},{trim:function(){return n(this,3)}})},126:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},138:function(e,t,a){var n=a(53),c="["+a(126)+"]",i=RegExp("^"+c+c+"*"),l=RegExp(c+c+"*$");e.exports=function(e,t){return e=String(n(e)),1&t&&(e=e.replace(i,"")),2&t&&(e=e.replace(l,"")),e}},139:function(e,t,a){var n=a(10),c=a(126);e.exports=function(e){return n(function(){return!!c[e]()||"​᠎"!="​᠎"[e]()||c[e].name!==e})}},140:function(e,t,a){"use strict";var n=a(128),c=a(9),i=a(53),l=a(67),r=a(107),s=a(29),o=a(109),u=a(110),d=a(10),m=[].push,p=Math.min,f=!d(function(){return!RegExp(4294967295,"y")});a(111)("split",2,function(e,t,a){var d;return d="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,a){var c=String(i(this)),l=void 0===a?4294967295:a>>>0;if(0===l)return[];if(void 0===e)return[c];if(!n(e))return t.call(c,e,l);for(var r,s,o,d=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,E=new RegExp(e.source,p+"g");(r=u.call(E,c))&&!((s=E.lastIndex)>f&&(d.push(c.slice(f,r.index)),r.length>1&&r.index<c.length&&m.apply(d,r.slice(1)),o=r[0].length,f=s,d.length>=l));)E.lastIndex===r.index&&E.lastIndex++;return f===c.length?!o&&E.test("")||d.push(""):d.push(c.slice(f)),d.length>l?d.slice(0,l):d}:"0".split(void 0,0).length?function(e,a){return void 0===e&&0===a?[]:t.call(this,e,a)}:t,[function(t,a){var n=i(this),c=null==t?void 0:t[e];return void 0!==c?c.call(t,n,a):d.call(String(n),t,a)},function(e,n){var i=a(d,e,this,n,d!==t);if(i.done)return i.value;var u=c(e),m=String(this),E=l(u,RegExp),h=u.unicode,b=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(f?"y":"g"),v=new E(f?u:"^(?:"+u.source+")",b),g=void 0===n?4294967295:n>>>0;if(0===g)return[];if(0===m.length)return null===o(v,m)?[m]:[];for(var x=0,N=0,y=[];N<m.length;){v.lastIndex=f?N:0;var k,C=o(v,f?m:m.slice(N));if(null===C||(k=p(s(v.lastIndex+(f?0:N)),m.length))===x)N=r(m,N,h);else{if(y.push(m.slice(x,N)),y.length===g)return y;for(var O=1;O<=C.length-1;O++)if(y.push(C[O]),y.length===g)return y;N=x=k}}return y.push(m.slice(x)),y}]},!f)},154:function(e,t,a){"use strict";a.r(t);a(106),a(123),a(125),a(101);var n=a(0),c=a.n(n),i=a(104);const l=Object(n.createContext)(null);function r(e){let t=e.children;const a=Object(n.useReducer)(s,{title:"",description:"",cards:[]}),i=a[0],r=a[1],o=Object(n.useMemo)(()=>({state:i,dispatch:r}),[i]);return c.a.createElement(l.Provider,{value:o},t)}function s(e,t){const a=e.cards[t.index];switch(t.type){case"RESET_DECK":return Object.assign({},t.deck);case"UPDATE_DECK":return Object.assign({},e,{[t.name]:t.value});case"ADD_CARD":return Object.assign({},e,{cards:[...e.cards,t.card]});case"REMOVE_CARD":return e.cards.splice(t.index,1),Object.assign({},e);case"UPDATE_SIDE_VALUE":return a[t.side][t.key]=t.value,Object.assign({},e);case"ADD_ATTACHMENT":return a.front.attachment=t.attachment,Object.assign({},e);case"REMOVE_ATTACHMENT":return delete a.front.attachment,Object.assign({},e);case"CHANGE_ANSWER_TYPE":return a.back.type=t.answerType,Object.assign({},e);case"ADD_OPTION":return a.back.options.push({id:Object(i.a)()}),Object.assign({},e);case"REMOVE_OPTION":return a.back.correct=0,a.back.options.splice(t.optionIndex,1),Object.assign({},e);case"CHANGE_CORRECT_ANSWER":return a.back.correct=t.optionIndex,Object.assign({},e);case"UPDATE_OPTION_TEXT":return a.back.options[t.optionIndex].text=t.value,Object.assign({},e);case"UPDATE_EXACT_ANSWER":return a.back[t.name]=t.value,Object.assign({},e);default:return e}}var o=a(102),u=a(13);function d(e){let t=e.textSize,a=e.handleChange;return c.a.createElement("select",{className:"input create-side-select",title:"Text size",defaultValue:t,onChange:a},c.a.createElement("option",{value:"16"},"16px"),c.a.createElement("option",{value:"24"},"24px"),c.a.createElement("option",{value:"36"},"36px"),c.a.createElement("option",{value:"48"},"48px"))}a(140);function m(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class p extends c.a.Component{constructor(e){super(e),m(this,"hide",()=>{this.props.hide()}),m(this,"handleFileUpload",e=>{let t=e.target;const a=this.props.type,n=t.files[0];t.value="",n.type.split("/")[0]!==a?this.showMessage("File is not an "+a):this.props.addAttachment(n,a)}),m(this,"handleFileUploadFormURL",e=>{const t=e.target.elements.url.value.trim(),a=this.props.type;if(e.preventDefault(),t){if("image"===a){const e=new Image;e.onload=(()=>{this.props.addAttachment(t,a)}),e.onerror=(e=>{this.showMessage("URL doesn't contain "+a+" file"),console.log(e)}),e.src=t}else if("audio"===a){const e=new Audio(t);e.onloadedmetadata=(()=>{this.props.addAttachment(t,a)}),e.onerror=(e=>{this.showMessage("URL doesn't contain "+a+" file"),console.log(e)})}}else this.showMessage("Please specify valid url")}),this.state={message:""}}showMessage(e){this.setState({message:e}),setTimeout(()=>{this.setState({message:""})},3200)}render(){const e=this.props.type,t=this.state.message;return c.a.createElement("div",{className:"mask"},c.a.createElement("div",{className:"modal upload-panel"},c.a.createElement("div",{className:"upload-panel-device-target"},c.a.createElement("div",{className:"upload-panel-device-target-title"},"Select ",e," file from device"),c.a.createElement("label",{className:"btn",tabIndex:"0"},c.a.createElement("span",null,"Select"),c.a.createElement("input",{type:"file",className:"file-input",onChange:this.handleFileUpload}))),c.a.createElement("div",{className:"upload-panel-item-separator"},"Or"),c.a.createElement("div",{className:"upload-panel-url-target"},c.a.createElement("div",{className:"upload-panel-url-target-title"},"Upload ",e," from url"),c.a.createElement("form",{onSubmit:this.handleFileUploadFormURL},c.a.createElement("input",{type:"text",name:"url",className:"input upload-panel-url-target-input"}),c.a.createElement("button",{className:"btn"},"Upload"))),c.a.createElement("div",{className:"upload-panel-footer"},t&&c.a.createElement("div",{className:"upload-panel-message"},t),c.a.createElement("button",{type:"button",className:"btn btn-text",onClick:this.hide},"Cancel"))))}}var f=a(112);function E(e){let t=e.index,a=e.side,i=e.handleChange;const r=Object(n.useContext)(l).dispatch,s=Object(n.useState)({type:"",visible:!1}),o=s[0],m=s[1],E=a.text,h=a.textSize,b=a.attachment;function v(){r({type:"REMOVE_ATTACHMENT",index:t})}function g(){m({visible:!1,type:""})}return c.a.createElement(n.Fragment,null,c.a.createElement("div",null,c.a.createElement("div",{className:"deck-form-field-title"},"FRONT"),c.a.createElement("div",{className:"create-side-toolbar"},["image","audio"].map((e,t)=>c.a.createElement("button",{key:t,className:"btn btn-icon toolbar-btn",title:"Upload "+e,onClick:()=>(function(e){m({visible:!0,type:e})})(e)},c.a.createElement(u.a,{name:e}))),c.a.createElement(d,{textSize:h,handleChange:e=>i(e,"front","textSize")})),c.a.createElement("div",{className:"create-side-content"},b&&c.a.createElement("div",{className:"create-side-panel"},c.a.createElement("button",{type:"button",className:"btn btn-icon create-side-panel-btn",onClick:v,title:"Remove attachment"},c.a.createElement(u.a,{name:"remove"})),c.a.createElement(f.a,b)),c.a.createElement("textarea",{className:"input create-side-text-input",value:E,style:{fontSize:h+"px"},onChange:e=>i(e,"front","text")}))),o.visible&&c.a.createElement(p,{type:o.type,hide:g,addAttachment:function(e,a){r({type:"ADD_ATTACHMENT",index:t,attachment:{file:e,type:a}}),g()}}))}function h(e){let t=e.index,a=e.handleChange;const i=Object(n.useContext)(l),r=i.state,s=i.dispatch,o=r.cards[t],m=o.back,p=o.id,f=m.type,E=m.text,h=m.textSize,b=m.options,v=m.correct;function g(e,a){s({type:"REMOVE_OPTION",index:t,optionIndex:e,id:a})}function x(e){s({type:"CHANGE_CORRECT_ANSWER",index:t,optionIndex:e})}function N(e){let a=e.target;const n=a.name,c=a.value;c!==m.options[n].text&&s({type:"UPDATE_OPTION_TEXT",optionIndex:parseInt(n,10),index:t,value:c})}function y(e){let a=e.target;const n=a.name,c=a.value,i=a.checked;s({type:"UPDATE_EXACT_ANSWER",name:n,value:"caseSensitive"===n?i:c,index:t})}return c.a.createElement("div",null,c.a.createElement("div",{className:"deck-form-field-title"},"BACK"),c.a.createElement("div",{className:"create-side-toolbar"},c.a.createElement("ul",{className:"create-side-types",onChange:function(e){let a=e.target;s({type:"CHANGE_ANSWER_TYPE",answerType:a.value,index:t})}},c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"radio-input",value:"text",name:"type-"+p,defaultChecked:"text"===f}),c.a.createElement(u.a,{name:"text",title:"Text",className:"create-option-type-icon"}))),c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"radio-input",value:"multi",name:"type-"+p,defaultChecked:"multi"===f}),c.a.createElement(u.a,{name:"list",title:"Multiple choice",className:"create-option-type-icon"}))),c.a.createElement("li",{className:"create-side-type"},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"radio-input",value:"exact",name:"type-"+p,defaultChecked:"exact"===f}),c.a.createElement(u.a,{name:"text-short",title:"Exact answer",className:"create-option-type-icon"})))),"text"===f&&c.a.createElement(d,{textSize:h,handleChange:e=>a(e,"back","textSize")}),"multi"===f&&c.a.createElement("button",{className:"btn btn-icon",onClick:function(){s({type:"ADD_OPTION",index:t})},title:"Add option"},c.a.createElement(u.a,{name:"add-list-item"}))),c.a.createElement("div",{className:"create-side-content"},function(e){return"text"===e?c.a.createElement("textarea",{className:"input create-side-text-input",value:E,style:{fontSize:h+"px"},onChange:e=>a(e,"back","text")}):"exact"===e?c.a.createElement("div",{onChange:y},c.a.createElement("label",{className:"creact-exact-input-container"},c.a.createElement("div",{className:"creact-exact-input-title"},"Provide answer:"),c.a.createElement("input",{type:"text",className:"input creact-exact-input",name:"input",autoComplete:"off",defaultValue:m.input})),c.a.createElement("label",{className:"creact-exact-checkbox-container"},c.a.createElement("input",{type:"checkbox",className:"checkbox-input",name:"caseSensitive",defaultChecked:m.caseSensitive}),c.a.createElement("div",{className:"checkbox creact-exact-checkbox"},c.a.createElement("div",{className:"checkbox-tick"})),c.a.createElement("span",null,"Case sensitive"))):c.a.createElement("ul",null,b.map((e,t)=>{let a=e.text,n=e.id;return c.a.createElement("li",{className:"create-option",key:n},c.a.createElement("label",null,c.a.createElement("input",{type:"radio",className:"radio-input",name:p,checked:v===t,onChange:()=>x(t)}),c.a.createElement("div",{className:"radio create-option-radio",title:"Mark answer as correct"})),c.a.createElement("input",{type:"text",className:"input create-option-input",name:t,defaultValue:a,autoComplete:"off",onChange:N}),c.a.createElement("button",{className:"btn btn-icon",title:"Remove answer",onClick:()=>g(t,n)},c.a.createElement(u.a,{name:"remove"})))}))}(f)))}function b(e){let t=e.index,a=e.card,i=e.removeCard;const r=Object(n.useContext)(l),s=r.state,o=r.dispatch;function d(e,n,c){const i=e.target.value;i!==a[n][c]&&o({type:"UPDATE_SIDE_VALUE",index:t,side:n,key:c,value:i})}return c.a.createElement("li",{className:"create-list-item"},c.a.createElement("div",{className:"create-card-index"},t+1,"."),c.a.createElement("div",{className:"deck-form-field-group create-card"},c.a.createElement(E,{index:t,side:a.front,handleChange:d}),c.a.createElement(h,{index:t,handleChange:d})),c.a.createElement("div",{className:"create-card-btns"},s.cards.length>1&&c.a.createElement("button",{className:"btn btn-icon",title:"Remove card",onClick:()=>i(t)},c.a.createElement(u.a,{name:"remove"}))))}function v(e){const t=Object(n.useContext)(l),a=t.state,r=t.dispatch,s=Object(n.useState)(""),u=s[0],d=s[1],m=Object(n.useState)([]),p=m[0],f=m[1],E=Object(n.useRef)();let h=0,v=0;function g(){return{id:Object(i.a)(),front:{text:"",textSize:16},back:{type:"text",text:"",textSize:16,input:"",correct:0,options:[{id:Object(i.a)()},{id:Object(i.a)()}]}}}function x(e){const t=a.cards[e];(N(t.front)||y(t.back))&&f([...p,t]),r({type:"REMOVE_CARD",index:e})}function N(e){return e.text||e.attachment}function y(e){if("text"===e.type)return e.text.length>0;if("exact"===e.type)return e.input.length>0;return e.options.reduce((e,t)=>{return t.text&&(e+=1),e},0)>1}function k(e){let t=e.target;const a=t.name,n=t.value;r({type:"UPDATE_DECK",name:a,value:n})}return Object(n.useEffect)(()=>{const t=e.match.params.id;if(t&&!e.location.state)Object(o.b)().then(e=>{const a=function(e,t){return e.find(e=>{let a=e.id;return a===t})}(e,t);a&&(a.cards=a.cards.map(e=>Object.assign({},g(),e)),r({type:"RESET_DECK",deck:a}))});else{const t=function(e){void 0===e&&(e={});return Object.assign({id:Object(i.a)(),title:"",description:"",cards:[g()]},e)}(e.location.state);t.cards=t.cards.map(e=>Object.assign({},g(),e)),r({type:"RESET_DECK",deck:t})}},[]),Object(n.useEffect)(()=>(clearTimeout(h),h=setTimeout(()=>{d("")},3200),()=>{clearTimeout(h)}),[u]),Object(n.useEffect)(()=>(clearTimeout(v),p.length>0&&(v=setTimeout(()=>{f([])},8e3)),()=>{clearTimeout(v)}),[p.length]),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"deck-form-field-group"},c.a.createElement("label",null,c.a.createElement("div",{className:"deck-form-field-title"},"TITLE"),c.a.createElement("input",{className:"input create-title-input",name:"title",value:a.title,onChange:k})),c.a.createElement("label",null,c.a.createElement("div",{className:"deck-form-field-title"},"DESCRIPTION (OPTIONAL)"),c.a.createElement("textarea",{className:"input create-description-input",name:"description",value:a.description,onChange:k}))),c.a.createElement("ul",null,a.cards.map((e,t)=>c.a.createElement(b,{key:e.id,index:t,card:e,removeCard:x}))),p.length>0&&c.a.createElement("div",{className:"deck-form-dialog"},c.a.createElement("span",null,"Removed ",p.length," card",p.length>1?"s":""),c.a.createElement("button",{className:"btn btn-text",onClick:function(){clearTimeout(v),f([]),r({type:"RESET_DECK",deck:Object.assign({},a,{cards:a.cards.concat(p)})})}},"UNDO")),c.a.createElement("div",{className:"container-footer create-footer"},c.a.createElement("button",{className:"btn",onClick:function(){const e=a.cards[a.cards.length-1],t=g();e&&(t.front.textSize=e.front.textSize,t.back.textSize=e.back.textSize,t.back.type=e.back.type),r({type:"ADD_CARD",card:t})},ref:E},"New Card"),u&&c.a.createElement("span",{className:"create-message"},u),c.a.createElement("button",{className:"btn",onClick:function(){if(!a.title)return void d("Title is required");(function(e){let t=0;for(const a of e){const e=a.front,n=a.back;N(e)&&y(n)&&(t+=1)}if(t!==e.length)d("Please fill in both card sides");else{if(!(t<2))return!0;d("Please fill in at least two cards")}})(a.cards)&&(a.cards=a.cards.map(e=>"multi"===e.back.type?(e.back.text="",e.back.input="",e.back.caseSensitive=!1,e.back.options=e.back.options.filter(e=>e.text),e):(e.back.correct=0,e.back.options=e.back.options.slice(0,2).map(e=>(e.text="",e)),"text"===e.back.type?(e.back.input="",e.back.caseSensitive=!1):"exact"===e.back.type&&(e.back.input=e.back.input.trim(),e.back.text=""),e)),e.history.push({pathname:"/decks",state:a}))}},"Create")))}function g(e){return c.a.createElement(r,null,c.a.createElement(v,e))}a.d(t,"default",function(){return g})}}]);