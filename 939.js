(globalThis.webpackChunknimus_cards=globalThis.webpackChunknimus_cards||[]).push([[939],{8939:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>g});var a=n(7294),c=n(3727),s=n(5620),l=n(446),i=n(1461),r=n(8997);function o({removeDeck:e,cancelRemoval:t}){return a.createElement(r.Z,{hide:t},a.createElement("h3",{className:"modal-title"},"Are you sure you want to remove this deck?"),a.createElement("div",{className:"deck-remove-modal-footer"},a.createElement("button",{className:"btn btn-text deck-remove-modal-cancel-btn",onClick:t},"Cancel"),a.createElement("button",{className:"btn btn-negative btn-negative-text deck-remove-modal-confirm-btn",onClick:e},"Remove")))}var d=n(3255);const m=function({children:e,hide:t}){return a.createElement(r.Z,{hide:t},e,a.createElement("div",{className:"decks-settings-footer"},a.createElement("button",{className:"btn btn-text decks-settings-hide-btn",onClick:t},"Close")))};const u=function({hide:e}){const[t,n]=(0,a.useState)((0,d.T)());function c({target:e}){const a=e.getAttribute("data-name"),c={...t[a]};switch(e.type){case"checkbox":c.value=e.checked;break;case"text":c.valid=e.validity.valid,c.value=e.value}n({...t,[a]:c})}return a.createElement(m,{hide:function(){const n=(0,d.T)(),{cardCount:a,timeoutDuration:c,textSize:s}=t;a.valid&&(n.cardCount.value=parseInt(a.value,10)||0),c.valid&&(n.timeoutDuration.value=parseInt(c.value,10)||0),n.textSize.value=parseFloat(s.value),n.randomize=t.randomize,(0,d.z)(n),e()}},a.createElement("h3",{className:"modal-title"},"Global Deck Settings"),a.createElement("label",{className:"decks-settings-item decks-settings-item-spaced"},a.createElement("span",null,"Text size"),a.createElement("select",{className:"input decks-settings-select",value:t.textSize.value,onChange:function({target:e}){n({...t,textSize:{value:e.value}})}},a.createElement("option",{value:"0.875"},"Small"),a.createElement("option",{value:"1"},"Medium"),a.createElement("option",{value:"1.125"},"Big"),a.createElement("option",{value:"1.25"},"Huge"))),a.createElement("label",{className:"checkbox-container decks-settings-item decks-settings-item-spaced"},a.createElement("span",null,"Randomize cards"),a.createElement("input",{type:"checkbox",className:"sr-only checkbox-input","data-name":"randomize",onChange:c,checked:t.randomize.value}),a.createElement("div",{className:"checkbox decks-settings-checkbox"},a.createElement("div",{className:"checkbox-tick"}))),a.createElement("label",{className:"decks-settings-item"},a.createElement("span",null,"Use"),a.createElement("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"cardCount",onChange:c,pattern:"[0-9]*$",value:t.cardCount.value}),a.createElement("span",null,"cards per study session"),a.createElement("div",{className:"decks-settings-message"},"Please provide a valid whole number.")),a.createElement("label",{className:"decks-settings-item"},a.createElement("span",null,"Reveal answer after"),a.createElement("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"timeoutDuration",onChange:c,pattern:"^0*|0*([5-9][0-9]*|[1-9]+[0-9]+)$",value:t.timeoutDuration.value}),a.createElement("span",null,"seconds"),a.createElement("div",{className:"decks-settings-message"},"Please provide a valid whole number.",a.createElement("br",null)," Minimal accepted value is 5 seconds.")))};var b=n(3465),k=n.n(b);const p=function({deck:e,hide:t}){const n=e.settings||{...(0,d.T)(),useGlobalSettings:{value:!0}},[c,s]=(0,a.useState)(k()(n)),i=c.useGlobalSettings.value;function r({target:e}){const t=e.getAttribute("data-name"),n={...c[t]};switch(e.type){case"checkbox":n.value=e.checked;break;case"text":n.valid=e.validity.valid,n.value=e.value}s({...c,[t]:n})}return a.createElement(m,{hide:function(){const{cardCount:a,timeoutDuration:s}=c;a.valid&&(n.cardCount.value=parseInt(a.value,10)||0),s.valid&&(n.timeoutDuration.value=parseInt(s.value,10)||0),n.useGlobalSettings=c.useGlobalSettings,n.randomize=c.randomize,e.settings=n,(0,l.C2)(e),t()}},a.createElement("h3",{className:"modal-title"},"Deck Settings"),a.createElement("label",{className:"decks-settings-item decks-settings-item-spaced checkbox-container"},a.createElement("span",null,"Use global settings"),a.createElement("input",{type:"checkbox",className:"sr-only checkbox-input","data-name":"useGlobalSettings",onChange:r,defaultChecked:i}),a.createElement("div",{className:"checkbox decks-settings-checkbox"},a.createElement("div",{className:"checkbox-tick"}))),a.createElement("label",{className:"decks-settings-item decks-settings-item-spaced"+(i?" disabled":"")},a.createElement("span",null,"Randomize cards"),a.createElement("input",{type:"checkbox",className:"sr-only checkbox-input","data-name":"randomize",onChange:r,checked:c.randomize.value,disabled:i}),a.createElement("div",{className:"checkbox decks-settings-checkbox"},a.createElement("div",{className:"checkbox-tick"}))),a.createElement("label",{className:"decks-settings-item"+(i?" disabled":"")},a.createElement("span",null,"Use"),a.createElement("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"cardCount",onChange:r,pattern:"[0-9]*$",value:c.cardCount.value,disabled:i}),a.createElement("span",null,"cards per study session"),a.createElement("div",{className:"decks-settings-message"},"Please provide a valid whole number.")),a.createElement("label",{className:"decks-settings-item"+(i?" disabled":"")},a.createElement("span",null,"Reveal answer after"),a.createElement("input",{type:"text",className:"input decks-settings-input",inputMode:"numeric","data-name":"timeoutDuration",onChange:r,pattern:"^0*|0*([5-9][0-9]*|[1-9]+[0-9]+)$",value:c.timeoutDuration.value,disabled:i}),a.createElement("span",null,"seconds"),a.createElement("div",{className:"decks-settings-message"},"Please provide a valid whole number.",a.createElement("br",null)," Minimal accepted value is 5 seconds.")))};const v=function({children:e}){const[{id:t,visible:n},c]=(0,a.useState)({id:"",visible:!1}),l=(0,a.useCallback)((function({target:e}){const n=e.closest(".dropdown-container");let a=!0;n&&n.id===t&&(a=e.closest(".dropdown-btn"));a&&(r.current&&c({id:t,visible:!1}),window.removeEventListener("click",l))}),[t]),r=(0,a.useRef)(!1);return(0,a.useEffect)((()=>(r.current=!0,c({visible:n,id:(0,s.zO)()}),()=>{r.current=!1,window.removeEventListener("click",l)})),[]),a.createElement("div",{id:t,className:"dropdown-container"},a.createElement("button",{className:"btn btn-icon",onClick:function(){n?window.removeEventListener("click",l):window.addEventListener("click",l),c({id:t,visible:!n})}},a.createElement(i.Z,{name:"dots-vertical"})),n&&a.createElement("div",{className:"dropdown"},e))};function E({deck:e,showDialog:t,showDeckSettings:n,exportDeck:s}){return a.createElement("li",{className:"deck"},a.createElement("div",{className:"deck-body"},a.createElement("div",null,a.createElement("h2",{className:"deck-title"},e.title),e.description&&a.createElement("p",{className:"deck-description"},e.description),a.createElement("div",{className:"deck-info"},a.createElement("div",{className:"deck-info-item"},e.cards.length," card",e.cards.length>1&&"s"),a.createElement("div",{className:"deck-info-item"},function(){const t=e.modifiedAt?"Modified":"Created",n=Date.now()-(e.modifiedAt||e.createdAt),a=6e4,c=36e5,s=24*c,l=30*s,i=365.25*s;if(n<a)return`${t} just now`;const r=function(e,t){return(n,a)=>{const c=Math.round(e/a);return`${t} ${c} ${n}${c>1?"s":""} ago`}}(n,t);return n<c?r("minute",a):n<s?r("hour",c):n<l?r("day",s):n<i?r("month",l):r("year",i)}()))),a.createElement(v,null,a.createElement("button",{className:"btn btn-icon-text dropdown-btn",onClick:()=>n(e)},a.createElement(i.Z,{name:"settings"}),a.createElement("span",null,"Settings")),a.createElement(c.rU,{to:`/decks/${e.id}`,className:"btn btn-icon-text dropdown-btn"},a.createElement(i.Z,{name:"list"}),a.createElement("span",null,"Status")),a.createElement(c.rU,{to:`/decks/${e.id}/edit`,className:"btn btn-icon-text dropdown-btn"},a.createElement(i.Z,{name:"edit"}),a.createElement("span",null,"Edit")),a.createElement("button",{className:"btn btn-icon-text dropdown-btn",onClick:()=>s(e)},a.createElement(i.Z,{name:"export"}),a.createElement("span",null,"Export")),a.createElement("button",{className:"btn btn-icon-text dropdown-btn",onClick:()=>t(e.id)},a.createElement(i.Z,{name:"remove"}),a.createElement("span",null,"Remove")))),a.createElement("div",{className:"deck-btn-container"},e.hasCardsToLearn?a.createElement(c.rU,{to:`/decks/${e.id}/learn`,className:"btn btn-text deck-btn"},"Learn"):a.createElement("span",{className:"btn btn-text deck-btn disabled"},"Learn"),e.hasCardsToReview?a.createElement(c.rU,{to:`/decks/${e.id}/review`,className:"btn btn-text deck-btn"},"Review"):a.createElement("span",{className:"btn btn-text deck-btn disabled"},"Review"),a.createElement(c.rU,{to:`/decks/${e.id}/practice`,className:"btn btn-text deck-btn"},"Practice")))}const g=function(){const[e,t]=(0,a.useState)([]),[r,d]=(0,a.useState)({visible:!1}),[m,b]=(0,a.useState)(!0);function k(e){d({deckRemoveModalVisible:!0,id:e})}function v(e){d({deckSettingsVisible:!0,deck:e})}function g(){d({})}async function h(e){const[{default:t},{default:a}]=await Promise.all([n.e(162).then(n.t.bind(n,3162,23)),Promise.all([n.e(85),n.e(791)]).then(n.t.bind(n,6085,23))]),c=new a,s=c.folder(e.title);s.file("metadata.json",JSON.stringify({title:e.title,description:e.description},null,2)),e.cards.forEach(((e,t)=>{const n=e.front.attachment;let a;n&&(n.blob?(a={type:n.type,description:n.description,mimeType:n.blob.type,blobName:n.blob.name},s.file(n.blob.name,new Blob([n.blob],{type:n.blob.type}))):a=n),s.file(`${t}.json`,JSON.stringify({...e,front:{...e.front,attachment:a}},null,2))}));t(await c.generateAsync({type:"blob"}),`${e.title}.zip`)}return(0,a.useEffect)((()=>{(0,l.GT)().then((e=>{t(e.map((e=>(e.hasCardsToLearn=!!(0,s.OZ)(e.cards).length,e.hasCardsToReview=!!(0,s.Vb)(e.cards).length,e)))),b(!1),(0,s.Dk)("Your decks")}))}),[]),a.createElement(a.Fragment,null,a.createElement("div",{className:"decks-header"},a.createElement("h1",{className:"decks-title"},"Your Decks"),a.createElement(c.rU,{to:"/decks/create",className:"btn deck-create-link"},"Create")),a.createElement("div",{className:"decks-top-bar"},a.createElement("label",{className:"btn btn-icon-text decks-top-bar-item deck-import-input-container"},a.createElement(i.Z,{name:"import"}),a.createElement("span",null,"Import"),a.createElement("input",{type:"file",className:"sr-only",onChange:async function({target:a}){const[c]=a.files,{default:i}=await Promise.all([n.e(85),n.e(791)]).then(n.t.bind(n,6085,23)),r=await i.loadAsync(c),o={id:(0,s.zO)(),title:"",description:"",createdAt:Date.now(),cards:[]};for(const[e,t]of Object.entries(r.files))if(e.endsWith("/metadata.json")){const e=JSON.parse(await t.async("string"));Object.assign(o,e)}else if(e.endsWith(".json")){const e=JSON.parse(await t.async("string")),n=e.front.attachment;if(e.id=(0,s.zO)(),n&&n.blobName){const{blobName:e}=n,t=r.files[`${o.title}/${e}`];n.blob=new File([await t.async("blob")],e,{type:n.mimeType}),delete n.blobName,delete n.mimeType}o.cards.push(e)}t([...e,o]),(0,l.C2)(o),a.value=""}})),a.createElement("button",{className:"btn btn-icon-text decks-top-bar-item",onClick:function(){d({settingsVisible:!0})}},a.createElement(i.Z,{name:"settings"}),a.createElement("span",null,"Settings"))),m?"":e.length?a.createElement("ul",{className:"decks"},function(e){return e.map((e=>a.createElement(E,{key:e.id,deck:e,showDialog:k,showDeckSettings:v,exportDeck:h})))}(e)):a.createElement("h2",{className:"decks-message"},"You have no decks"),r.deckRemoveModalVisible&&a.createElement(o,{removeDeck:function(){const n=function(e,t){return e.findIndex((({id:e})=>e===t))}(e,r.id);e.splice(n,1),t([...e]),(0,l.$P)(r.id),g()},cancelRemoval:g}),r.settingsVisible&&a.createElement(u,{hide:g}),r.deckSettingsVisible&&a.createElement(p,{hide:g,deck:r.deck}))}},8997:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var a=n(7294);const c=function({className:e,hide:t,children:n}){const c=(0,a.useCallback)((function({key:e}){"Escape"===e&&t()}),[]);return(0,a.useEffect)((()=>(window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)})),[]),a.createElement("div",{className:"modal-mask",onClick:function({target:e,currentTarget:n}){e===n&&t()}},a.createElement("div",{className:"modal"+(e?` ${e}`:"")},n))}},446:(e,t,n)=>{"use strict";n.d(t,{GT:()=>c,VC:()=>s,C2:()=>l,$P:()=>i});const a=new(n(9642).Z)("nimus-cards");function c(){return a.decks.toArray().then(r).catch((e=>{console.log(e)}))}function s(e){return a.decks.get(e)}function l(e){a.decks.put(e).catch((e=>{console.log(e)}))}function i(e){a.decks.delete(e).catch((e=>{console.log(e)}))}function r(e){return e.sort(((e,t)=>e.createdAt<t.createdAt?1:e.createdAt>t.createdAt?-1:0))}a.version(1).stores({decks:"id"})},3255:(e,t,n)=>{"use strict";n.d(t,{T:()=>l,z:()=>i});var a=n(3465),c=n.n(a);let s={textSize:{value:1},randomize:{value:!0},cardCount:{value:10},timeoutDuration:{value:""},...JSON.parse(localStorage.getItem("nimus-cards-settings"))};function l(){return c()(s)}function i(e){s={...s,...e},localStorage.setItem("nimus-cards-settings",JSON.stringify(s))}}}]);